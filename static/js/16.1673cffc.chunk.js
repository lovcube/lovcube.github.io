(this.webpackJsonpframeweb=this.webpackJsonpframeweb||[]).push([[16],{733:function(e,a,t){"use strict";var n=t(0),i=t.n(n),l=t(19);t(188);a.a=function(){return i.a.createElement("div",{id:"Footer"},i.a.createElement("p",{className:"foot-copyright"},l.a.t("copyright")))}},750:function(e,a,t){},765:function(e,a,t){"use strict";t(72);var n,i,l=t(13),c=(t(64),t(17)),r=t(8),s=t(10),m=t(21),o=t(22),p=t(23),d=t(0),u=t.n(d),h=t(79),f=t.n(h),b=t(36),v=t(19),g=t(7),E=t(6),w=(t(750),t(751)),N=t.n(w),O=(t(752),Object(b.b)()(n=function(e){function a(e){var t;return Object(r.a)(this,a),(t=Object(m.a)(this,Object(o.a)(a).call(this,e))).image=u.a.createRef(),t.state={myCropper:null,afterImg:""},t}return Object(p.a)(a,e),Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=new N.a(this.image.current,{viewMode:1,dragMode:"none",initialAspectRatio:1,aspectRatio:1,preview:".before",background:!1,autoCropArea:.6,zoomOnWheel:!1});this.setState({myCropper:a},(function(){e.state.myCropper.replace(e.props.img)}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var a=e.img;this.props.img!==a&&this.state.myCropper.replace(a)}},{key:"render",value:function(){var e=this,a=this.props,t=a.t,n=a.confirm,i=a.cancel;return u.a.createElement("div",{className:"preview_picture"},u.a.createElement("div",{className:"preview_left"},u.a.createElement("div",{className:"show-img"},u.a.createElement("img",{src:this.props.img,ref:this.image,alt:""})),u.a.createElement("div",{className:"preview_btn"},u.a.createElement("span",{className:"confirm",onClick:function(){n(e.state.myCropper)}},t("Determine")),u.a.createElement("span",{className:"cancel",onClick:i},t("Cancel")))),u.a.createElement("div",{className:"preview_right"},u.a.createElement("p",null,t("imagePreview")),u.a.createElement("div",{className:"before"})))}}]),a}(u.a.Component))||n);var j=Object(b.b)()(i=function(e){function a(e){var t;return Object(r.a)(this,a),(t=Object(m.a)(this,Object(o.a)(a).call(this,e))).handleChange=function(e){if(e.target.files.length>0){var a=e.target.files[0];if(a.size/1024/1024>3)return void c.a.error(v.a.t("Picsize"));!function(e,a){var t=new FileReader;t.addEventListener("load",(function(){return a(t.result)})),t.readAsDataURL(e)}(a,(function(e){t.setState({imageUrl:e,file:a})}))}},t.handleCancel=function(){t.props.handleCancel()},t.handleconfirm=function(e){t.props.handleCancel();var a="portrait";c.a.loading({content:"uploading...",key:a,duration:0});var n=t.state.file,i=e.getCroppedCanvas({imageSmoothingQuality:"high"}).toDataURL("image/jpeg"),l=f.a.lib.WordArray.create(i),r=f.a.SHA256(l).toString(),s=Object(E.e)(i);Object(E.b)(s,"".concat(Object(g.a)(),"/up/p/").concat(Object(E.g)("cookie"),"/").concat(r,"/").concat(n.name)).then((function(e){Object(g.b)("user_profile_id_save",e.id).then((function(n){c.a.success({content:"succeed!",key:a,duration:2}),t.props.callback(null,e.id)})).catch((function(){c.a.error({content:"come to nothing",key:a,duration:3})}))}))},t.imageRef=u.a.createRef(),t.state={imageUrl:null},t}return Object(p.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this,a=this.state.imageUrl,t=this.props,n=t.t,i=t.handleCancel;return u.a.createElement("div",{className:"Headportrait-wrap"},u.a.createElement("div",{className:"Modify_the_picture"},u.a.createElement("span",{className:"close-icon",onClick:i},u.a.createElement(l.a,{type:"close"})),u.a.createElement("div",{className:"Modify_head"},n("Headimage")),u.a.createElement("div",{className:"Modify_content"},u.a.createElement("p",null,n("uploadavatar")),u.a.createElement("div",{className:"Modify_openimg"},u.a.createElement("input",{type:"button",className:"pass-portrait-filebtn",name:"openImgBtn",id:"openImgBtn",value:n("Choosepicture")}),u.a.createElement("input",{type:"file",className:"pass-portrait-file",accept:"image/bmp,image/jpeg,image/png",name:"file",id:"fileImg",onChange:function(a){e.handleChange(a)}}),u.a.createElement("span",{className:"pass-portrait-msg"},n("SupportPic"))),a&&u.a.createElement(O,{img:this.state.imageUrl,confirm:this.handleconfirm,cancel:this.handleCancel}))))}}]),a}(u.a.Component))||i;a.a=j},981:function(e,a,t){},988:function(e,a,t){"use strict";t.r(a);t(187);var n,i,l,c,r,s=t(117),m=(t(72),t(13)),o=(t(64),t(17)),p=t(4),d=t(8),u=t(10),h=t(21),f=t(22),b=t(18),v=t(23),g=t(2),E=(t(53),t(0)),w=t.n(E),N=t(36),O=t(39),j=t(6),k=t(7),_=t(733),y=(t(981),t(1)),C=t(765),R=t(12),V=t(19),U=Object(N.b)()(n=Object(O.b)("login")(n=Object(O.c)((i=function(e){function a(e){var t;return Object(d.a)(this,a),t=Object(h.a)(this,Object(f.a)(a).call(this,e)),Object(p.a)(t,"nameVisible",l,Object(b.a)(t)),Object(p.a)(t,"emailVisible",c,Object(b.a)(t)),Object(p.a)(t,"pwdVisible",r,Object(b.a)(t)),t.chengeEmailHide=function(e){"INPUT"!==e.target.nodeName&&(t.emailVisible=!1,t.nameVisible=!1)},t.changeName=function(e){if(e.nativeEvent.stopImmediatePropagation(),t.nameVisible){var a=t.props.login.user_detail,n=Object(j.t)(t.nameRef.current.value);if(""===n)return void o.a.error(V.a.t("NicknameEmpty"));if(t.nameVisible=!1,n!==Object(y.h)(a,"nickname")){if(!j.m.nickname.test(n))return void o.a.error(V.a.t("nicknameValidity"));Object(k.b)("user_set_nickname",n,1).then((function(){t.props.login.getUser_detail(),R.a.emit("setNickname",{type:"nickname",data:n})}))}}else if(t.nameVisible=!0,t.props.login.firstInit){var i=t.props.login.user_detail;Object(y.h)(i,"nickname")?t.nameRef.current.value=Object(y.h)(i,"nickname"):t.nameRef.current.value=Object(y.h)(i,"name")}else t.props.login.getUser_detail((function(){var e=t.props.login.user_detail;Object(y.h)(e,"nickname")?t.nameRef.current.value=Object(y.h)(e,"nickname"):t.nameRef.current.value=Object(y.h)(e,"name")}))},t.changeEmail=function(e){e.nativeEvent.stopImmediatePropagation();var a=j.q.get("Z_H_U_DATA");if(t.emailVisible){var n=t.props.login.user_detail,i=t.emailRef.current.value;if(!i)return void(t.emailVisible=!1);j.m.email.test(i)?(t.emailVisible=!1,i!==Object(y.h)(n,"email")&&(t.props.login.checkEmail(i)?o.a.error(V.a.t("boundmail")):t.props.login.setEmail(i,(function(){a.email=i,j.q.set("Z_H_U_DATA",a)})))):o.a.error(V.a.t("emailValidity"))}else t.emailVisible=!0,a.email?t.emailRef.current.value=a.email:t.emailRef.current.value=""},t.showModule=function(){t.setState({visible:!0})},t.hideModal=function(){t.setState({visible:!1})},t.preserve=function(){var e=Object(j.t)(t.old_pwdRef.current.value),a=Object(j.t)(t.new_pwdRef.current.value),n=j.q.get("user");e?a?j.m.pwd.test(a)?e===n.pwd?e!==a?(Object(k.b)("user_repassword",{oldpwd:e,newpwd:a},1).then((function(){n.pwd=a,j.q.set("user",n)})),t.pwdVisible=!1):o.a.error(V.a.t("oldnewsame")):o.a.error(V.a.t("oldpwdinc")):o.a.error(V.a.t("pwdFormat")):o.a.error(V.a.t("enterset")):o.a.error(V.a.t("enterOldpwd"))},t.upPortrait=function(e,a){t.props.login.getUser_detail(),R.a.emit("setNickname",{type:"portrait",data:a})},t.nameRef=w.a.createRef(),t.pwdref=w.a.createRef(),t.emailRef=w.a.createRef(),t.old_pwdRef=w.a.createRef(),t.new_pwdRef=w.a.createRef(),t.state={visible:!1},t}return Object(v.a)(a,e),Object(u.a)(a,[{key:"componentDidMount",value:function(){this.pwdref.current.value="999999999999",this.props.login.getUser_detail(),document.addEventListener("click",this.chengeEmailHide)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.chengeEmailHide)}},{key:"render",value:function(){var e=this,a=this.props.t,t=this.nameVisible,n=this.emailVisible,i=this.pwdVisible,l=this.state.visible,c=this.props.login.user_detail;return w.a.createElement("div",{className:"personal_main"},w.a.createElement("div",{className:"personal_content"},w.a.createElement("div",{className:"p-content"},w.a.createElement("div",{className:"content-header"},w.a.createElement("h2",null,a("accountmanagement")),w.a.createElement("div",{className:"plate-1"},w.a.createElement("div",{className:"subhead"},w.a.createElement("h4",null,a("Personalinformation"))),w.a.createElement("div",{className:"headportrait"},w.a.createElement("div",{className:"left"},w.a.createElement("span",null,a("HeadPortrait"))),w.a.createElement("div",{className:"middle"},Object(y.h)(c,"profile")?w.a.createElement("img",{alt:"profile",src:"".concat(Object(k.a)(),"/uf/s/").concat(Object(y.h)(c,"profile").id,"/").concat(Object(y.h)(c,"id"))}):w.a.createElement("span",null,w.a.createElement(m.a,{type:"user"}))),w.a.createElement("div",{className:"right",onClick:this.showModule},w.a.createElement("span",null,a("ChangetheAvatar")))),w.a.createElement("div",{className:"nickname"},w.a.createElement("div",{className:"left"},w.a.createElement("span",null,a("Nickname"))),w.a.createElement("div",{className:"middle"},w.a.createElement(s.a,{placement:"topLeft",overlayClassName:"tooltip",trigger:"focus",title:a("pwdreg")},w.a.createElement("input",{style:{display:t?"block":"none"},spellCheck:!1,type:"text",maxLength:50,ref:this.nameRef,placeholder:a("SetNickname")})),w.a.createElement("p",{className:"staticname ellipsis",style:{display:t?"none":"block"}},c.nickname?c.nickname:c.name)),w.a.createElement("div",{className:"right",onClick:this.changeName},w.a.createElement("span",null,a(t?"Determine":"ChangeNickname"))))),w.a.createElement("div",{className:"plate-2"},w.a.createElement("div",{className:"subhead"},w.a.createElement("h4",null,a("accountinformation"))),w.a.createElement("div",{className:"nickname"},w.a.createElement("div",{className:"left"},w.a.createElement("span",null,a("UserName"))),w.a.createElement("div",{className:"middle"},w.a.createElement("p",{className:"staticname ellipsis"},j.q.get("Z_H_U_DATA").name))),w.a.createElement("div",{className:"headportrait"},w.a.createElement("div",{className:"left"},w.a.createElement("span",null,a("mailbox"))),w.a.createElement("div",{className:"middle"},w.a.createElement("input",{style:{display:n?"block":"none"},spellCheck:!1,type:"email",ref:this.emailRef,placeholder:a("enterEmail")}),w.a.createElement("p",{style:{display:n?"none":"block"}},Object(y.h)(c,"email")?Object(y.h)(c,"email").replace(/(.{1}).+(.{2}@.+)/g,"$1****$2"):"\u8fd8\u672a\u7ed1\u5b9a\u90ae\u7bb1")),w.a.createElement("div",{className:"right",onClick:this.changeEmail},w.a.createElement("span",null,a(n?"Determine":"Changingmailbox")))),w.a.createElement("div",{className:"nickname"},w.a.createElement("div",{className:"left"},w.a.createElement("span",null,a("Password"))),w.a.createElement("div",{className:"middle"},w.a.createElement("input",{className:"pwd",type:"password",ref:this.pwdref,readOnly:!0})),w.a.createElement("div",{className:"right",onClick:function(){e.pwdVisible=!0}},w.a.createElement("span",null,a("Changepassword"))))),w.a.createElement("div",{className:"plate-3"})))),l&&w.a.createElement(C.a,{userId:c.id,handleCancel:this.hideModal,callback:this.upPortrait}),i&&w.a.createElement("div",{className:"changepwd-inner"},w.a.createElement("div",{className:"changepwd-content"},w.a.createElement("span",{className:"close_icon",onClick:function(){e.pwdVisible=!1}},w.a.createElement(m.a,{type:"close"})),w.a.createElement("div",{className:"changepwd-head"},w.a.createElement("h4",null,a("ChangePwd"))),w.a.createElement("div",{className:"changepwd-bd"},w.a.createElement("p",{className:"pwd_item"},w.a.createElement("label",{className:"pwd_label",htmlFor:"old_pwd"},a("Oldpwd")),w.a.createElement("input",{id:"old_pwd",className:"pwd_input",type:"password",ref:this.old_pwdRef,placeholder:a("enterOldpwd")})),w.a.createElement("p",{className:"pwd_item"},w.a.createElement("label",{className:"pwd_label",htmlFor:"new_pwd"},a("NewPwd")),w.a.createElement(s.a,{placement:"topRight",overlayClassName:"tooltip",trigger:"focus",title:a("pwdreg")},w.a.createElement("input",{id:"new_pwd",className:"pwd_input",type:"password",ref:this.new_pwdRef,placeholder:a("enterNewpwd")})))),w.a.createElement("div",{className:"changepwd-ft"},w.a.createElement("span",{className:"changepwd-btn",onClick:this.preserve},a("Preservation"))))),w.a.createElement(_.a,null))}}]),a}(E.Component),l=Object(g.a)(i.prototype,"nameVisible",[y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=Object(g.a)(i.prototype,"emailVisible",[y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r=Object(g.a)(i.prototype,"pwdVisible",[y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n=i))||n)||n)||n;a.default=U}}]);
//# sourceMappingURL=16.1673cffc.chunk.js.map