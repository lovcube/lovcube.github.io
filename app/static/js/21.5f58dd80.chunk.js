(this.webpackJsonplovcube=this.webpackJsonplovcube||[]).push([[21],{1027:function(e,a,t){},1098:function(e,a,t){"use strict";t.r(a);t(288);var n,i,l,r,c,s=t(171),o=(t(289),t(86)),m=(t(145),t(57)),p=(t(76),t(10)),d=(t(169),t(99)),u=(t(295),t(163)),h=(t(77),t(18)),f=t(4),b=t(9),g=t(12),v=t(20),E=t(21),w=t(19),N=t(22),y=t(3),O=(t(63),t(0)),j=t.n(O),k=t(34),_=t(37),C=t(6),R=t(7),V=t(790),x=(t(1027),t(1)),P=t(833),U=t(14),A=t(16),M=function(e){function a(){var e,t;Object(b.a)(this,a);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return(t=Object(v.a)(this,(e=Object(E.a)(a)).call.apply(e,[this].concat(i)))).state={},t}return Object(N.a)(a,e),Object(g.a)(a,[{key:"render",value:function(){var e=this.props,a=e.title,t=e.btn,n=e.clickBtn,i=e.middleNode,l=e.style;return j.a.createElement(s.a,{type:"flex",align:"middle",justify:"space-between",gutter:[0,{xs:8}],className:"plate_cell",style:l},j.a.createElement(o.a,{sm:{span:5},xs:{span:24}},j.a.createElement("span",{className:"title_left"},a," :")),j.a.createElement(o.a,{sm:{span:11},xs:{span:12}},i),j.a.createElement(o.a,{sm:{span:8},xs:{span:12},className:"xs_inner"},n&&j.a.createElement(m.a,{onClick:n},t)))}}]),a}(O.PureComponent),D=j.a.forwardRef((function(e,a){var t=e.id,n=e.title,i=e.placeholder,l=e.style;return j.a.createElement(s.a,{type:"flex",align:"middle",justify:"space-between",gutter:[0,{xs:8}],className:"plate_cell",style:l},j.a.createElement(o.a,{sm:{span:8},xs:{span:24}},j.a.createElement("label",{className:"pwd_label",htmlFor:t},n,":")),j.a.createElement(o.a,{sm:{span:16},xs:{span:24}},j.a.createElement("input",{id:t,className:"pwd_input",type:"password",ref:a,placeholder:i})))})),H=Object(k.b)()(n=Object(_.b)("login")(n=Object(_.c)((i=function(e){function a(e){var t;return Object(b.a)(this,a),t=Object(v.a)(this,Object(E.a)(a).call(this,e)),Object(f.a)(t,"nameVisible",l,Object(w.a)(t)),Object(f.a)(t,"emailVisible",r,Object(w.a)(t)),Object(f.a)(t,"pwdVisible",c,Object(w.a)(t)),t.chengeEmailHide=function(e){"INPUT"!==e.target.nodeName&&(t.emailVisible=!1,t.nameVisible=!1)},t.changeName=function(e){e.nativeEvent.stopImmediatePropagation();var a=t.props.login.user_detail;if(t.nameVisible){var n=Object(C.u)(t.nameRef.current.value);if(""===n)return void h.a.error(A.a.t("NicknameEmpty"));if(n!==Object(x.h)(a,"nickname")){if(!C.l.nickname.test(n))return void h.a.error(A.a.t("nicknameValidity"));Object(R.b)("user_set_nickname",n,1).then((function(){t.props.login.getUser_detail()}))}}t.nameVisible=!t.nameVisible,t.nameRef.current.value=Object(x.h)(a,"nickname")||Object(x.h)(a,"name")},t.changeEmail=function(e){e.nativeEvent.stopImmediatePropagation();var a=t.props.login.user_detail,n=C.r.get("Z_H_U_DATA");if(t.emailVisible){var i=t.emailRef.current.value;if(!i)return void(t.emailVisible=!1);C.l.email.test(i)?i!==Object(x.h)(a,"email")&&(t.props.login.checkEmail(i)?h.a.error(A.a.t("boundmail")):t.props.login.setEmail(i,(function(){n.email=i,C.r.set("Z_H_U_DATA",n)}))):h.a.error(A.a.t("emailValidity"))}t.emailVisible=!t.emailVisible,t.emailRef.current.value=n.email||""},t.showModule=function(){t.setState({visible:!0})},t.hideModal=function(){t.setState({visible:!1})},t.preserve=function(){var e=Object(C.u)(t.old_pwdRef.current.value),a=Object(C.u)(t.new_pwdRef.current.value),n=C.r.get("user");e?a?C.l.pwd.test(a)?e===n.pwd?e!==a?(Object(R.b)("user_repassword",{oldpwd:e,newpwd:a},1).then((function(){n.pwd=a,C.r.set("user",n)})),t.pwdVisible=!1):h.a.error(A.a.t("oldnewsame")):h.a.error(A.a.t("oldpwdinc")):h.a.error(A.a.t("pwdFormat")):h.a.error(A.a.t("enterset")):h.a.error(A.a.t("enterOldpwd"))},t.upPortrait=function(e,a){t.props.login.getUser_detail(),U.a.emit("setNickname",{type:"portrait",data:a})},t.nameRef=j.a.createRef(),t.pwdref=j.a.createRef(),t.emailRef=j.a.createRef(),t.old_pwdRef=j.a.createRef(),t.new_pwdRef=j.a.createRef(),t.state={visible:!1},t}return Object(N.a)(a,e),Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.props.login.user_detail;this.props.login.getUser_detail((function(){e.nameRef.current.value=Object(x.h)(a,"nickname")||Object(x.h)(a,"name")})),document.addEventListener("click",this.chengeEmailHide)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.chengeEmailHide)}},{key:"render",value:function(){var e=this,a=this.props.t,t=this.nameVisible,n=this.emailVisible,i=this.pwdVisible,l=this.state.visible,r=this.props.login.user_detail;return j.a.createElement("div",{className:"personal_main"},j.a.createElement("div",{className:"personal_content"},j.a.createElement("div",{className:"p-content"},j.a.createElement("div",{className:"content-header"},j.a.createElement("h2",null,a("accountmanagement")),j.a.createElement("div",{className:"plate-1"},j.a.createElement("div",{className:"subhead"},j.a.createElement("h4",null,a("Personalinformation"))),j.a.createElement(M,{title:a("HeadPortrait"),btn:a("ChangetheAvatar"),clickBtn:this.showModule,middleNode:Object(x.h)(r,"profile")?j.a.createElement(u.a,{size:50,src:"".concat(Object(R.a)(),"/uf/s/").concat(Object(x.h)(r,"profile").id,"/").concat(Object(x.h)(r,"id"))}):j.a.createElement(u.a,{size:50,icon:"user"})}),j.a.createElement(M,{title:a("Nickname"),btn:a(t?"Determine":"ChangeNickname"),clickBtn:this.changeName,middleNode:j.a.createElement(j.a.Fragment,null,j.a.createElement(d.a,{placement:"topLeft",overlayClassName:"tooltip",trigger:"focus",title:a("pwdreg")},j.a.createElement("input",{className:"middle_input",style:{display:t?"block":"none"},spellCheck:!1,type:"text",maxLength:50,ref:this.nameRef,placeholder:a("SetNickname")})),j.a.createElement("p",{className:"staticname ellipsis",style:{display:t?"none":"block"}},r.nickname?r.nickname:r.name))})),j.a.createElement("div",{className:"plate-2"},j.a.createElement("div",{className:"subhead"},j.a.createElement("h4",null,a("accountinformation"))),j.a.createElement(M,{title:a("UserName"),middleNode:j.a.createElement("p",{className:"staticname ellipsis"},C.r.get("Z_H_U_DATA").name)}),j.a.createElement(M,{title:a("mailbox"),btn:a(n?"Determine":"Changingmailbox"),clickBtn:this.changeEmail,middleNode:j.a.createElement(j.a.Fragment,null,j.a.createElement("input",{className:"middle_input",style:{display:n?"block":"none"},spellCheck:!1,type:"email",ref:this.emailRef,placeholder:a("enterEmail")}),j.a.createElement("p",{className:"staticname ellipsis",style:{display:n?"none":"block"}},Object(x.h)(r,"email")?Object(x.h)(r,"email").replace(/(.{1}).+(.{2}@.+)/g,"$1****$2"):a("NotMailbox")))}),j.a.createElement(M,{title:a("Password"),btn:a("Changepassword"),clickBtn:function(){e.pwdVisible=!0},middleNode:j.a.createElement("input",{className:"middle_input pwd",type:"password",defaultValue:"************",readOnly:!0}),style:{border:0}}))))),l&&j.a.createElement(P.a,{userId:r.id,handleCancel:this.hideModal,callback:this.upPortrait}),i&&j.a.createElement("div",{className:"changepwd-inner"},j.a.createElement("div",{className:"changepwd-content"},j.a.createElement("span",{className:"close_icon",onClick:function(){e.pwdVisible=!1}},j.a.createElement(p.a,{type:"close"})),j.a.createElement("div",{className:"changepwd-head"},j.a.createElement("h4",null,a("ChangePwd"))),j.a.createElement("div",{className:"changepwd-bd"},j.a.createElement(D,{title:a("Oldpwd"),ref:this.old_pwdRef,placeholder:a("enterOldpwd")}),j.a.createElement(D,{title:a("NewPwd"),ref:this.new_pwdRef,placeholder:a("enterNewpwd")})),j.a.createElement(s.a,{className:"changepwd-ft"},j.a.createElement(o.a,{sm:{span:16,push:4},xs:{span:24,push:0}},j.a.createElement(m.a,{className:"changepwd-btn",type:"primary",onClick:this.preserve},a("Preservation")))))),j.a.createElement(V.a,null))}}]),a}(O.Component),l=Object(y.a)(i.prototype,"nameVisible",[x.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r=Object(y.a)(i.prototype,"emailVisible",[x.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=Object(y.a)(i.prototype,"pwdVisible",[x.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n=i))||n)||n)||n;a.default=H},790:function(e,a,t){"use strict";var n=t(0),i=t.n(n),l=t(16),r=(t(210),t(294));a.a=function(){return i.a.createElement("div",{id:"Footer"},i.a.createElement("p",{className:"foot-copyright"},l.a.t("copyright").format(r.a.name,r.a.version)))}},815:function(e,a,t){},833:function(e,a,t){"use strict";t(76);var n,i,l=t(10),r=(t(77),t(18)),c=t(9),s=t(12),o=t(20),m=t(21),p=t(22),d=t(0),u=t.n(d),h=t(90),f=t.n(h),b=t(34),g=t(16),v=t(7),E=t(6),w=(t(815),t(816)),N=t.n(w),y=(t(817),Object(b.b)()(n=function(e){function a(e){var t;return Object(c.a)(this,a),(t=Object(o.a)(this,Object(m.a)(a).call(this,e))).image=u.a.createRef(),t.state={myCropper:null,afterImg:""},t}return Object(p.a)(a,e),Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=new N.a(this.image.current,{viewMode:1,dragMode:"none",initialAspectRatio:1,aspectRatio:1,preview:".before",background:!1,autoCropArea:.6,zoomOnWheel:!1});this.setState({myCropper:a},(function(){e.state.myCropper.replace(e.props.img)}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var a=e.img;this.props.img!==a&&this.state.myCropper.replace(a)}},{key:"render",value:function(){var e=this,a=this.props,t=a.t,n=a.confirm,i=a.cancel;return u.a.createElement("div",{className:"preview_picture"},u.a.createElement("div",{className:"preview_left"},u.a.createElement("div",{className:"show-img"},u.a.createElement("img",{src:this.props.img,ref:this.image,alt:""})),u.a.createElement("div",{className:"preview_btn"},u.a.createElement("span",{className:"confirm",onClick:function(){n(e.state.myCropper)}},t("Determine")),u.a.createElement("span",{className:"cancel",onClick:i},t("Cancel")))),u.a.createElement("div",{className:"preview_right"},u.a.createElement("p",null,t("imagePreview")),u.a.createElement("div",{className:"before"})))}}]),a}(u.a.Component))||n);var O=Object(b.b)()(i=function(e){function a(e){var t;return Object(c.a)(this,a),(t=Object(o.a)(this,Object(m.a)(a).call(this,e))).handleChange=function(e){if(e.target.files.length>0){var a=e.target.files[0];if(a.size/1024/1024>3)return void r.a.error(g.a.t("Picsize"));!function(e,a){var t=new FileReader;t.addEventListener("load",(function(){return a(t.result)})),t.readAsDataURL(e)}(a,(function(e){t.setState({imageUrl:e,file:a})}))}},t.handleCancel=function(){t.props.handleCancel()},t.handleconfirm=function(e){t.props.handleCancel();var a="portrait";r.a.loading({content:"uploading...",key:a,duration:0});var n=t.state.file,i=e.getCroppedCanvas({imageSmoothingQuality:"high"}).toDataURL("image/jpeg"),l=f.a.lib.WordArray.create(i),c=f.a.SHA256(l).toString(),s=Object(E.e)(i);Object(E.b)(s,"".concat(Object(v.a)(),"/up/p/").concat(Object(E.g)("cookie"),"/").concat(c,"/").concat(n.name)).then((function(e){Object(v.b)("user_profile_id_save",e.id).then((function(n){r.a.success({content:"succeed!",key:a,duration:2}),t.props.callback(null,e.id)})).catch((function(){r.a.error({content:"come to nothing",key:a,duration:3})}))}))},t.imageRef=u.a.createRef(),t.state={imageUrl:null},t}return Object(p.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this,a=this.state.imageUrl,t=this.props,n=t.t,i=t.handleCancel;return u.a.createElement("div",{className:"Headportrait-wrap"},u.a.createElement("div",{className:"Modify_the_picture"},u.a.createElement("span",{className:"close-icon",onClick:i},u.a.createElement(l.a,{type:"close"})),u.a.createElement("div",{className:"Modify_head"},n("Headimage")),u.a.createElement("div",{className:"Modify_content"},u.a.createElement("p",null,n("uploadavatar")),u.a.createElement("div",{className:"Modify_openimg"},u.a.createElement("input",{type:"button",className:"pass-portrait-filebtn",name:"openImgBtn",id:"openImgBtn",value:n("Choosepicture")}),u.a.createElement("input",{type:"file",className:"pass-portrait-file",accept:"image/bmp,image/jpeg,image/png",name:"file",id:"fileImg",onChange:function(a){e.handleChange(a)}}),u.a.createElement("span",{className:"pass-portrait-msg"},n("SupportPic"))),a&&u.a.createElement(y,{img:this.state.imageUrl,confirm:this.handleconfirm,cancel:this.handleCancel}))))}}]),a}(u.a.Component))||i;a.a=O}}]);
//# sourceMappingURL=21.5f58dd80.chunk.js.map