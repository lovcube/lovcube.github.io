(this.webpackJsonplovcube=this.webpackJsonplovcube||[]).push([[7],{1090:function(e,t,a){"use strict";a.r(t);a(145);var n,i,r,s,o,l=a(57),c=(a(895),a(983)),m=(a(169),a(99)),u=(a(835),a(894)),p=(a(288),a(171)),f=(a(76),a(10)),d=(a(295),a(163)),h=(a(289),a(86)),v=(a(77),a(18)),b=a(9),g=a(12),E=a(20),y=a(21),C=a(22),O=(a(836),a(893)),_=(a(902),a(1089)),j=a(0),k=a.n(j),w=a(114),N=a(34),S=a(37),x=(a(905),a(6)),R=a(7),I=a(833),q=(a(209),a(128)),A=Object(N.b)()(n=O.a.create({name:"questions"})(n=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.props.form.setFieldsValue({text:this.props.val})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,i=e.form,r=e.t,s=i.getFieldDecorator;return k.a.createElement(q.a,{visible:t,title:r("CustomQuestions"),okText:r("Determine"),onOk:n,onCancel:a,getContainer:!1},k.a.createElement(O.a.Item,{label:r("securityQuestion")},s("text",{rules:[{required:!0,message:r("enterQuestion"),whitespace:!0},{max:100,message:r("Notmorechar")}]})(k.a.createElement(u.a,{autoComplete:"off",placeholder:r("enterQuestion")}))))}}]),t}(j.Component))||n)||n,D=a(14),F=a(297),M=a(147),P=_.a.Option,L=(i=Object(N.b)(),r=O.a.create({name:"perfectinformation"}),s=Object(S.b)("login","playlist","rahmen","photoalbum"),i(o=r(o=Object(w.g)(o=s(o=Object(S.c)(o=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(y.a)(t).call(this,e))).show=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({pro_visible:!0,fiag:!0})},a.setCustom=function(e){a.setState({custom:!0,checkId:0}),setTimeout((function(){a.customRef.current.focus()}),0)},a.input_focus=function(e,t){e.nativeEvent.stopImmediatePropagation(),a.setState({focus:t})},a.input_blur=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({focus:null})},a.headporId=function(e,t){D.a.emit("avatar",t)},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFieldsAndScroll((function(e,t){if(!e){var n={nickname:Object(x.u)(t.nickname),email:t.email,pwd_question:t.question,pwd_answer:t.answer};if(a.state.profile_id&&(n.profile_id=a.state.profile_id),a.state.show)return void v.a.error(a.t("boundmail"));a.props.login.info_login(n,(function(){var e=x.r.get("user"),t={name:e.name,pwd:e.pwd};a.props.login.login_in(t,(function(){a.props.history.push("/")}))}))}}))},a.handleCancel=function(){a.setState({visible:!1})},a.handleCreate=function(){var e=a.formRef.props.form;e.validateFields((function(t,n){t||(a.props.form.setFieldsValue({question:Object(x.u)(n.text)}),e.resetFields(),a.setState({visible:!1}))}))},a.saveFormRef=function(e){a.formRef=e},a.getAvatar=function(){return"".concat(Object(R.a)(),"/uf/s/").concat(a.state.profile_id,"/").concat(a.state.user_id)},a.addItem=function(){var e=a.props.form.getFieldValue("question")||"";a.setState({questionVal:e,visible:!0})},a.AnswerValidity=function(e,t,n){return t.length<2?n(a.props.t("answerValidity")):Object(x.t)(t)?n():void n(a.props.t("answerValidity"))},a.check_email=function(e){Object(R.b)("user_check_email",e.target.value).then((function(e){a.setState({show:!0})})).catch((function(e){2===e.state&&a.setState({show:!1})}))},a.nameRef=k.a.createRef(),a.emailRef=k.a.createRef(),a.answerRef=k.a.createRef(),a.customRef=k.a.createRef(),a.t=a.props.t,a.state={head_visible:!1,problemList:[{id:1,text:a.t("birthday")},{id:2,text:a.t("yourmind")},{id:3,text:a.t("favoriteperson")}],focus:null,profile_id:null,fiag:!1,visible:!1,user_id:null,show:!1,questionVal:""},a}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=x.r.get("user"),a=this.props.match.params.id;Number(a)===t.id?this.setState({user_id:a}):(x.r.get("user")&&Object(R.b)("user_logout",null),x.r.remove("user"),this.props.history.push("/login")),this.avatar=D.a.on("avatar",(function(t){e.setState({profile_id:t})}))}},{key:"componentWillUnmount",value:function(){D.a.rm(this.avatar)}},{key:"change",value:function(e,t){e.stopPropagation();var a=this.state.problemList,n=a.findIndex((function(e){return e.id===t}));this.setState({custom:!1,checkId:t,problem:a[n].text,pro_visible:!1})}},{key:"render",value:function(){var e=this,t=this.props.t,a=this.props.form.getFieldDecorator,n=this.state,i=n.problemList,r=n.show,s=n.head_visible,o=n.profile_id,v=n.questionVal,b=r?{hasFeedback:!0,validateStatus:"error"}:{};return k.a.createElement("div",{className:"perfectinformation-content"},k.a.createElement(F.a,{buyUrl:M.a,title:t("PerfectInfo")}),k.a.createElement("div",{className:"perfectinformation-inner"},k.a.createElement("div",{className:"perfectinformation-head"},k.a.createElement("h2",null,t("PerfectInfo")),k.a.createElement("span",{className:"hint"},"ps:",t("required"))),k.a.createElement(p.a,{className:"info_Avatar"},k.a.createElement(h.a,{xs:{span:6}},k.a.createElement("span",{className:"info_label"},t("HeadPortrait"),":")),k.a.createElement(h.a,{xs:{span:18}},k.a.createElement("div",{className:"profile_picture",onClick:function(){e.setState({head_visible:!0})}},o?k.a.createElement("img",{alt:"profile",src:this.getAvatar()}):k.a.createElement(d.a,{size:56,icon:"user"}),k.a.createElement(f.a,{className:"right-rigth",type:"right"})))),k.a.createElement(O.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmit}),k.a.createElement(O.a.Item,{label:t("Nickname")},k.a.createElement(m.a,{placement:"topLeft",overlayClassName:"tooltip",trigger:"focus",title:t("regrule4")},a("nickname",{rules:[{required:!0,message:t("NicknameEmpty"),whitespace:!0},{pattern:x.l.nickname,message:t("nicknameValidity")}]})(k.a.createElement(u.a,{autoComplete:"off",size:"large",maxLength:50,placeholder:t("SetNickname")})))),k.a.createElement(O.a.Item,Object.assign({label:t("mailbox")},b),a("email",{rules:[{pattern:x.l.email,message:"The input is not valid E-mail!"},{required:!0,message:t("MailboxEmpty")}]})(k.a.createElement(u.a,{onBlur:this.check_email,autoComplete:"off",size:"large",placeholder:t("SetMailbox")}))),k.a.createElement(O.a.Item,{label:t("securityQuestion")},a("question",{rules:[{required:!0,message:t("selectQuestion")}]})(k.a.createElement(_.a,{size:"large",placeholder:t("selectQuestion"),dropdownRender:function(a){return k.a.createElement("div",null,a,k.a.createElement(c.a,{style:{margin:"4px 0"}}),k.a.createElement("div",{className:"custom-issue",style:{padding:"4px 8px",cursor:"pointer"},onMouseDown:function(e){return e.preventDefault()},onClick:e.addItem},k.a.createElement(f.a,{type:"plus"})," ",t("CustomQuestions")))}},i.map((function(e){return k.a.createElement(P,{key:e.id,value:e.text},e.text)}))))),k.a.createElement(O.a.Item,{label:t("Answer")},k.a.createElement(m.a,{placement:"topLeft",overlayClassName:"tooltip",trigger:"focus",title:t("regrule6")},a("answer",{rules:[{required:!0,message:t("enterAnswer"),whitespace:!0}]})(k.a.createElement(u.a,{size:"large",maxLength:50,placeholder:t("enterAnswer")})))),k.a.createElement(O.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},k.a.createElement(l.a,{className:"confirm-btn",type:"primary",htmlType:"submit"},t("Determine")))),this.state.visible&&k.a.createElement(A,{wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,onCreate:this.handleCreate,val:v})),s&&k.a.createElement(I.a,{callback:this.headporId,handleCancel:function(){e.setState({head_visible:!1})}}),k.a.createElement("div",{className:"l-top"}),k.a.createElement("div",{className:"l-bottom"}))}}]),t}(j.Component))||o)||o)||o)||o)||o);t.default=L},815:function(e,t,a){},833:function(e,t,a){"use strict";a(76);var n,i,r=a(10),s=(a(77),a(18)),o=a(9),l=a(12),c=a(20),m=a(21),u=a(22),p=a(0),f=a.n(p),d=a(90),h=a.n(d),v=a(34),b=a(16),g=a(7),E=a(6),y=(a(815),a(816)),C=a.n(y),O=(a(817),Object(v.b)()(n=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).image=f.a.createRef(),a.state={myCropper:null,afterImg:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new C.a(this.image.current,{viewMode:1,dragMode:"none",initialAspectRatio:1,aspectRatio:1,preview:".before",background:!1,autoCropArea:.6,zoomOnWheel:!1});this.setState({myCropper:t},(function(){e.state.myCropper.replace(e.props.img)}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.img;this.props.img!==t&&this.state.myCropper.replace(t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.confirm,i=t.cancel;return f.a.createElement("div",{className:"preview_picture"},f.a.createElement("div",{className:"preview_left"},f.a.createElement("div",{className:"show-img"},f.a.createElement("img",{src:this.props.img,ref:this.image,alt:""})),f.a.createElement("div",{className:"preview_btn"},f.a.createElement("span",{className:"confirm",onClick:function(){n(e.state.myCropper)}},a("Determine")),f.a.createElement("span",{className:"cancel",onClick:i},a("Cancel")))),f.a.createElement("div",{className:"preview_right"},f.a.createElement("p",null,a("imagePreview")),f.a.createElement("div",{className:"before"})))}}]),t}(f.a.Component))||n);var _=Object(v.b)()(i=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){if(e.target.files.length>0){var t=e.target.files[0];if(t.size/1024/1024>3)return void s.a.error(b.a.t("Picsize"));!function(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}(t,(function(e){a.setState({imageUrl:e,file:t})}))}},a.handleCancel=function(){a.props.handleCancel()},a.handleconfirm=function(e){a.props.handleCancel();var t="portrait";s.a.loading({content:"uploading...",key:t,duration:0});var n=a.state.file,i=e.getCroppedCanvas({imageSmoothingQuality:"high"}).toDataURL("image/jpeg"),r=h.a.lib.WordArray.create(i),o=h.a.SHA256(r).toString(),l=Object(E.e)(i);Object(E.b)(l,"".concat(Object(g.a)(),"/up/p/").concat(Object(E.g)("cookie"),"/").concat(o,"/").concat(n.name)).then((function(e){Object(g.b)("user_profile_id_save",e.id).then((function(n){s.a.success({content:"succeed!",key:t,duration:2}),a.props.callback(null,e.id)})).catch((function(){s.a.error({content:"come to nothing",key:t,duration:3})}))}))},a.imageRef=f.a.createRef(),a.state={imageUrl:null},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state.imageUrl,a=this.props,n=a.t,i=a.handleCancel;return f.a.createElement("div",{className:"Headportrait-wrap"},f.a.createElement("div",{className:"Modify_the_picture"},f.a.createElement("span",{className:"close-icon",onClick:i},f.a.createElement(r.a,{type:"close"})),f.a.createElement("div",{className:"Modify_head"},n("Headimage")),f.a.createElement("div",{className:"Modify_content"},f.a.createElement("p",null,n("uploadavatar")),f.a.createElement("div",{className:"Modify_openimg"},f.a.createElement("input",{type:"button",className:"pass-portrait-filebtn",name:"openImgBtn",id:"openImgBtn",value:n("Choosepicture")}),f.a.createElement("input",{type:"file",className:"pass-portrait-file",accept:"image/bmp,image/jpeg,image/png",name:"file",id:"fileImg",onChange:function(t){e.handleChange(t)}}),f.a.createElement("span",{className:"pass-portrait-msg"},n("SupportPic"))),t&&f.a.createElement(O,{img:this.state.imageUrl,confirm:this.handleconfirm,cancel:this.handleCancel}))))}}]),t}(f.a.Component))||i;t.a=_},905:function(e,t,a){}}]);
//# sourceMappingURL=7.a6ea27dc.chunk.js.map