(this.webpackJsonplovcube=this.webpackJsonplovcube||[]).push([[25],{1102:function(e,a,t){"use strict";t.r(a);t(291);var n=t(173),l=(t(292),t(86)),i=(t(171),t(100)),c=(t(563),t(208)),s=(t(297),t(165)),r=(t(75),t(9)),o=(t(80),t(23)),m=t(4),d=t(10),u=t(12),f=t(19),_=t(20),b=t(17),p=t(21),h=t(3),g=(t(64),t(0)),E=t.n(g),v=t(31),k=t(37),y=t(880),x=t.n(y),L=t(290),N=t(289),O=t(65),w=t.n(O),j=t(6),C=t(7),R=(t(211),t(130)),I=(t(1028),t(1088)),S=(t(147),t(57)),D=t(143),P=t(55),z=t.n(P),B=t(15);function U(e){return new Promise((function(a,t){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return a(n.result)},n.onerror=function(e){return t(e)}}))}var A,F,M,T,W=function(e){function a(e){var t;return Object(d.a)(this,a),(t=Object(f.a)(this,Object(_.a)(a).call(this,e))).previewHandleCancel=function(e){t.setState({previewVisible:!1})},t.handlePreview=function(e){return z.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,z.a.awrap(U(e.originFileObj));case 3:e.preview=a.sent;case 4:t.setState({previewImage:e.url||e.preview,previewVisible:!0});case 5:case"end":return a.stop()}}))},t.handleChange=function(e){var a=e.fileList;return t.setState({fileList:a})},t.url=function(e){var a={file:e};return new Promise((function(t,n){var l,i;return z.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,z.a.awrap(Object(j.d)(a,{quality:.7},2048,2048));case 3:l=c.sent,i="".concat(Object(C.b)(),"/up/p/").concat(Object(j.g)("lovtok"),"/").concat(l.data.hash,"/").concat(e.name),t(i),c.next=11;break;case 8:c.prev=8,c.t0=c.catch(0),n(c.t0);case 11:case"end":return c.stop()}}),null,null,[[0,8]])}))},t.uploadImg=function(e){var a,n,l,i,c,s;return z.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.file,n=e.action,l=t.state.fileList,i={uid:a.uid,name:"hehe.png",status:"uploading",url:"",percent:50},t.setState({fileList:[].concat(Object(D.a)(l),[i]),upLoading:!0}),r.prev=4,r.next=7,z.a.awrap(Object(j.b)(a,n));case 7:c=r.sent,s={uid:a.uid,name:a.name,status:"done",url:j.h.file_s(c.id),id:c.id},t.props.visible&&t.setState({fileList:[].concat(Object(D.a)(l),[s]),upLoading:!1}),r.next=16;break;case 12:r.prev=12,r.t0=r.catch(4),o.a.error(B.a.t("feebfaid")),t.setState({upLoading:!1});case 16:case"end":return r.stop()}}),null,null,[[4,12]])},t.Ok=function(){var e,a=[],n=!t.props.add||t.inputRef.current.value.trim(),l=t.textareaRef.current.value.trim();n?l?(e=t.props.add?{subject:n,message:l}:{message:l},t.state.fileList.length&&(t.state.fileList.forEach((function(e){a.push(e.id)})),e.attach=a),t.state.upLoading?o.a.warning(B.a.t("feedWarning3")):t.props.handleOk(e,t.Cancel)):o.a.error(B.a.t("feedWarning2")):o.a.error(B.a.t("feedWarning1"))},t.handleCancel=function(e){t.props.handleCancel(t.Cancel)},t.Cancel=function(){t.textareaRef.current.value="",t.setState({fileList:[],upLoading:!1})},t.textareaRef=E.a.createRef(),t.inputRef=E.a.createRef(),t.state={previewVisible:!1,previewImage:"",fileList:[],upLoading:!1},t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"render",value:function(){var e=this.props,a=e.visible,t=e.add,n=e.confirmLoading,l=this.state,i=l.previewVisible,c=l.previewImage,s=l.fileList,o=l.upLoading,m=E.a.createElement("div",null,E.a.createElement(r.a,{type:"plus"}));return E.a.createElement(R.a,{centered:!0,title:B.a.t("ProblemFeedback"),visible:a,onOk:this.Ok,onCancel:this.handleCancel,destroyOnClose:!0,footer:t?E.a.createElement(S.a,{key:"submit",type:"primary",disabled:o,loading:n,onClick:this.Ok},B.a.t("Submit")):E.a.createElement(S.a,{key:"submit",type:"primary",disabled:o,loading:n,onClick:this.Ok},B.a.t("reply"))},t&&E.a.createElement("div",{className:"".concat(x.a.fb_block," clearfix")},E.a.createElement("div",{className:x.a.fb_lable},E.a.createElement("span",{className:x.a.fb_tips},"*"),E.a.createElement("span",{className:x.a.fb_title_tips},"Title:")),E.a.createElement("div",{className:x.a.fb_textarea},E.a.createElement("input",{placeholder:B.a.t("enterTitle"),maxLength:250,type:"text",ref:this.inputRef}))),E.a.createElement("div",{className:"".concat(x.a.fb_block," clearfix")},E.a.createElement("div",{className:x.a.fb_lable},E.a.createElement("span",{className:x.a.fb_tips},"*"),E.a.createElement("span",{className:x.a.fb_title_tips},"Message:")),E.a.createElement("div",{className:x.a.fb_textarea},E.a.createElement("textarea",{name:"content",id:"fb_des_content",placeholder:B.a.t("enterDdescription"),maxLength:1e3,ref:this.textareaRef}))),E.a.createElement("div",{className:"".concat(x.a.fb_block," clearfix")},E.a.createElement("div",{className:x.a.fb_lable1},E.a.createElement("span",{className:x.a.fb_title_tips},"Attach: (",B.a.t("Upto10"),")")),E.a.createElement("div",{className:"clearfix"},E.a.createElement(I.a,{action:this.url,accept:"image/bmp,image/gif,image/jpeg,image/png",customRequest:this.uploadImg,listType:"picture-card",fileList:s,onPreview:this.handlePreview,onChange:this.handleChange},s.length>=10?null:m),E.a.createElement(R.a,{visible:i,footer:null,bodyStyle:{textAlign:"center"},onCancel:this.previewHandleCancel,centered:!0},E.a.createElement("img",{alt:"example",style:{maxWidth:"80vw",maxHeight:"70vh"},src:c})))))}}]),a}(g.PureComponent),H=t(1),V=t(805),J=t(266),X=Object(v.b)()(A=Object(k.b)("feedback","login")(A=Object(k.c)((F=function(e){function a(e){var t;return Object(d.a)(this,a),t=Object(f.a)(this,Object(_.a)(a).call(this,e)),Object(m.a)(t,"inner",M,Object(b.a)(t)),Object(m.a)(t,"visible",T,Object(b.a)(t)),t.resize=function(){window.innerWidth<576?t.inner||(t.inner=!0):t.inner&&(t.inner=!1,t.visible=!1)},t.showModal=function(e){t.setState({visible:!0,add:e})},t.handleOk=function(e,a){t.setState({confirmLoading:!0}),t.state.add||(e.id=t.props.feedback.id),Object(C.c)("feedback_save",e,1).then((function(e){t.props.feedback.refreshtDetail(e)})).finally((function(){t.setState({visible:!1,confirmLoading:!1}),a&&a()}))},t.handleCancel=function(e){t.setState({add:null,visible:!1}),e&&e()},t.closeDialog=function(){t.setState({bImg_visible:!1,files:null})},t.onPiece=function(){t.imgidx-1>=0?t.onBigImg(t.state.files,t.imgidx-1):(t.imgidx=t.state.files.length-1,t.onBigImg(t.state.files,t.imgidx),o.a.warning(t.props.t("lastOne")))},t.nextPage=function(){if(t.imgidx+1>=t.state.files.length)return t.imgidx=0,t.onBigImg(t.state.files,t.imgidx),void o.a.warning(t.props.t("firstOne"));t.onBigImg(t.state.files,t.imgidx+1)},t.onBigImg=function(e,a){var n=e.length,l={id:e[a]};t.imgidx=a,t.setState({bImg_visible:!0,imgfile:l,files:e}),a+1<n&&Object(j.i)(j.h.file_b(e[a+1])),a-1<0||Object(j.i)(j.h.file_b(e[a-1]))},t.back=function(){t.visible=!1},t.ulRef=E.a.createRef(),t.boxRef=E.a.createRef(),t.state={avatar:!1,add:null,confirmLoading:!1,bImg_visible:!1,imgfile:{},files:null},t}return Object(p.a)(a,e),Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.feedback.getData((function(a){a.state===J.b&&e.props.history.push("/")})),this.resize(),window.addEventListener("resize",this.resize)}},{key:"componentWillUnmount",value:function(){this.props.login.getUser_detail(),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var e=this,a=this.props.feedback,t=a.init,o=a.id,m=a.listData,d=a.detail,u=a.detailInit,f=a.empty,_=a.subject,b=a.created,p=a.getDetail,h=a.user_id,g=this.props.t,v=this.state,k=v.visible,y=v.add,O=v.confirmLoading,R=v.bImg_visible,I=v.imgfile;return E.a.createElement("div",{className:x.a.feedback_inner},t?E.a.createElement(n.a,{style:{height:"100%"}},E.a.createElement(l.a,{xs:{span:24},sm:{span:9},md:{span:8},lg:{span:6},xl:{span:5},style:{height:"100%"}},this.visible?E.a.createElement("div",{className:x.a.feedback_right},u?f?E.a.createElement(N.a,null):E.a.createElement("div",{className:x.a.feedback_right_inner},E.a.createElement("div",{className:x.a.feedback_r_head},E.a.createElement("p",{className:"".concat(x.a.r_head_title," ellipsis"),onClick:this.back},E.a.createElement(r.a,{type:"left"}),_),E.a.createElement("p",{className:x.a.r_head_bottom},E.a.createElement("span",null,"id: ",o),E.a.createElement("span",null,w()(b).format(g("LL"))))),E.a.createElement("div",{className:x.a.r_bottom_body,ref:this.boxRef},E.a.createElement("ul",{ref:this.ulRef},d.map((function(a,t){return E.a.createElement("li",{key:t,className:x.a.detailList},a.user_id===h?E.a.createElement("p",{className:x.a.list},E.a.createElement("span",null,w()(a.created).format(g("LL"))),E.a.createElement("span",null,g("me"),"\xa0\xa0",a.profile?E.a.createElement(s.a,{src:"".concat(Object(C.b)(),"/uf/s/").concat(a.profile.id,"/").concat(a.user_id)}):E.a.createElement(s.a,{icon:"user"}))):E.a.createElement("p",{className:x.a.list},E.a.createElement("span",null,a.unread&&E.a.createElement(c.a,{status:"error"}),g("Admin"),"\xa0\xa0",a.profile?E.a.createElement(s.a,{src:"".concat(Object(C.b)(),"/uf/s/").concat(a.profile.id,"/").concat(a.user_id)}):E.a.createElement(s.a,{icon:"user"})),E.a.createElement("span",null,w()(a.created).format(g("LL")))),E.a.createElement("p",null,a.message),a.attach&&E.a.createElement("div",{className:x.a.attach},E.a.createElement("ul",null,a.attach.map((function(t,n){return E.a.createElement("li",{key:t,onClick:function(){e.onBigImg(a.attach,n)}},E.a.createElement("img",{src:a.user_id===h?j.h.file_s(t):j.h.feedback_s(t,a.user_id),alt:""}))})))))})))),E.a.createElement("div",{className:x.a.bottom_btn,onClick:function(){e.showModal(null)}},E.a.createElement(r.a,{type:"message"}),g("reply"))):E.a.createElement(L.a,null)):E.a.createElement("div",{className:x.a.feedback_left},E.a.createElement("div",{className:x.a.feedback_l_head},E.a.createElement("span",null,g("FeedbackHistory")),E.a.createElement(i.a,{placement:"bottom",title:g("addFeedback")},E.a.createElement(r.a,{type:"plus",onClick:function(){e.showModal("add")}}))),E.a.createElement("div",{className:x.a.feedback_l_body},E.a.createElement("ul",null,m.map((function(a){return E.a.createElement("li",{className:"".concat(x.a.l_listcell," ").concat(o===a.id?x.a.l_active:""),key:a.id,onClick:function(){e.inner?(e.visible=!0,p(a)):p(a)}},E.a.createElement("div",{className:x.a.subject},E.a.createElement(c.a,{count:a.unread}),a.subject),E.a.createElement("p",{className:x.a.message},a.message),E.a.createElement("p",{className:x.a.created},w()(a.created).format(g("LL"))))})))))),E.a.createElement(l.a,{xs:{span:0},sm:{span:15},md:{span:16},lg:{span:18},xl:{span:19},style:{height:"100%"}},E.a.createElement("div",{className:x.a.feedback_right},u?f?E.a.createElement(N.a,null):E.a.createElement("div",{className:x.a.feedback_right_inner},E.a.createElement("div",{className:x.a.feedback_r_head},E.a.createElement("p",{className:"".concat(x.a.r_head_title," ellipsis")},_),E.a.createElement("p",{className:x.a.r_head_bottom},E.a.createElement("span",null,"id: ",o),E.a.createElement("span",null,w()(b).format(g("LL"))))),E.a.createElement("div",{className:x.a.r_bottom_body,ref:this.boxRef},E.a.createElement("ul",{ref:this.ulRef},d.map((function(a,t){return E.a.createElement("li",{key:t,className:x.a.detailList},a.user_id===h?E.a.createElement("p",{className:x.a.list},E.a.createElement("span",null,w()(a.created).format(g("LL"))),E.a.createElement("span",null,g("me"),"\xa0\xa0",a.profile?E.a.createElement(s.a,{src:"".concat(Object(C.b)(),"/uf/s/").concat(a.profile.id,"/").concat(a.user_id)}):E.a.createElement(s.a,{icon:"user"}))):E.a.createElement("p",{className:x.a.list},E.a.createElement("span",null,a.unread&&E.a.createElement(c.a,{status:"error"}),g("Admin"),"\xa0\xa0",a.profile?E.a.createElement(s.a,{src:"".concat(Object(C.b)(),"/uf/s/").concat(a.profile.id,"/").concat(a.user_id)}):E.a.createElement(s.a,{icon:"user"})),E.a.createElement("span",null,w()(a.created).format(g("LL")))),E.a.createElement("p",null,a.message),a.attach&&E.a.createElement("div",{className:x.a.attach},E.a.createElement("ul",null,a.attach.map((function(t,n){return E.a.createElement("li",{key:t,onClick:function(){e.onBigImg(a.attach,n)}},E.a.createElement("img",{src:a.user_id===h?j.h.file_s(t):j.h.feedback_s(t,a.user_id),alt:""}))})))))})))),E.a.createElement("div",{className:x.a.bottom_btn,onClick:function(){e.showModal(null)}},E.a.createElement(r.a,{type:"message"}),g("reply"))):E.a.createElement(L.a,null)))):E.a.createElement(L.a,null),E.a.createElement(W,{visible:k,add:y,handleOk:this.handleOk,confirmLoading:O,handleCancel:this.handleCancel}),R&&E.a.createElement(V.a,{id:I.id,cpt:I.cpt,ext:I.ext,closeDialog:this.closeDialog,onPiece:this.onPiece,nextPage:this.nextPage}))}}]),a}(g.Component),M=Object(h.a)(F.prototype,"inner",[H.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=Object(h.a)(F.prototype,"visible",[H.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A=F))||A)||A)||A;a.default=X},880:function(e,a,t){e.exports={feedback_inner:"style_feedback_inner__1UQOL",feedback_left:"style_feedback_left__VxpUk",feedback_l_head:"style_feedback_l_head__3kd8W",feedback_l_body:"style_feedback_l_body__R709n",l_listcell:"style_l_listcell__1nDTe",subject:"style_subject__2U1SA",message:"style_message__K4SpM",created:"style_created__1zg5X",l_active:"style_l_active__TfZl9",feedback_right:"style_feedback_right__1oNxi",feedback_right_inner:"style_feedback_right_inner__zXtUD",feedback_r_head:"style_feedback_r_head__QHTow",r_head_title:"style_r_head_title__3gEz9",r_head_bottom:"style_r_head_bottom__2Yl5J",r_bottom_body:"style_r_bottom_body__3DRXN",detailList:"style_detailList__mIFRj",list:"style_list__1YGlT",attach:"style_attach__unvYo",bottom_btn:"style_bottom_btn__2tD07",fb_block:"style_fb_block__241Jp",fb_lable:"style_fb_lable__2SAuD",fb_tips:"style_fb_tips__37Ing",fb_title_tips:"style_fb_title_tips__3ZDSe",fb_lable1:"style_fb_lable1__3IDjB",fb_textarea:"style_fb_textarea__2Fdg9"}}}]);
//# sourceMappingURL=25.a1c3336f.chunk.js.map