{"version":3,"sources":["common/Secondhead/index.js","components/Headportrait/SelectProfilePic.js","components/Headportrait/index.js","components/Perfectinformation/Questions.js","components/Perfectinformation/index.js"],"names":["Secondhead","className","href","this","props","title","type","theme","buyBtn","Component","SelectProfilePic","withTranslation","image","React","createRef","state","myCropper","afterImg","Cropper","current","viewMode","dragMode","initialAspectRatio","aspectRatio","preview","background","autoCropArea","zoomOnWheel","setState","replace","img","t","confirm","cancel","src","ref","alt","onClick","Headportrait","handleChange","e","target","files","length","file","size","message","error","i18next","callback","reader","FileReader","addEventListener","result","readAsDataURL","getBase64","imageUrl","handleCancel","handleconfirm","cropper","key","loading","content","duration","afterimg","getCroppedCanvas","imageSmoothingQuality","toDataURL","wordArray","CryptoJS","lib","WordArray","create","hash","SHA256","toString","blob","dataURLtoBlob","ajaxPromise","host","getCookie","name","then","wsget","id","res","success","catch","imageRef","value","accept","onChange","Questions","form","setFieldsValue","text","val","visible","onCancel","onCreate","getFieldDecorator","okText","onOk","getContainer","Item","label","rules","required","whitespace","max","autoComplete","placeholder","Option","Perfectinformation","inject","withRouter","observer","show","nativeEvent","stopImmediatePropagation","pro_visible","fiag","setCustom","custom","checkId","setTimeout","customRef","focus","input_focus","txt","input_blur","headporId","a","event","emit","handleSubmit","preventDefault","validateFieldsAndScroll","err","values","data","nickname","trim","email","pwd_question","question","pwd_answer","answer","profile_id","login","info_login","user","storage","get","pwd","login_in","history","push","handleCreate","formRef","validateFields","resetFields","saveFormRef","getAvatar","user_id","addItem","getFieldValue","questionVal","AnswerValidity","rule","taskStr","check_email","nameRef","emailRef","answerRef","head_visible","problemList","userdata","match","params","Number","remove","avatar","on","rm","stopPropagation","idx","findIndex","el","problem","check_e","hasFeedback","validateStatus","icon","layout","onSubmit","placement","overlayClassName","trigger","pattern","reg","maxLength","onBlur","dropdownRender","menu","style","margin","padding","cursor","onMouseDown","map","item","htmlType","wrappedComponentRef"],"mappings":"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","file":"static/js/5.bc1c3eb0.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { Icon } from 'antd';\nimport './style.scss';\nimport Languageselect from '../Languageselect';\n\nexport default class Secondhead extends Component {\n  render() {\n    return (\n      <div className=\"second-header\">\n        <div className='logo'>\n          <h1>\n            <a href=\"/\">\n              <span>Photo Frame</span>\n            </a>\n          </h1>\n        </div>\n        <div className='title'>\n          <p>{this.props.title}</p>\n        </div>\n        <div className='second-header-right clearfix'>\n          <div className='language-inner'>\n            <Languageselect />\n          </div>\n          <div className='buy-btn'>\n            <a href=\"javasxript:;\"><Icon type=\"picture\" theme=\"filled\" />{this.props.buyBtn}</a>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}","import React from 'react';\nimport Cropper from 'cropperjs'\nimport { withTranslation } from 'react-i18next';\nimport 'cropperjs/dist/cropper.css'\n\n@withTranslation()\nclass SelectProfilePic extends React.Component {\n  constructor(props) {\n    super(props);\n    this.image = React.createRef();\n    this.state = {\n      myCropper: null,\n      afterImg: ''\n    }\n  }\n\n  componentDidMount() {\n    let myCropper = new Cropper(this.image.current, {\n      viewMode: 1,\n      dragMode: 'none',\n      initialAspectRatio: 1,\n      aspectRatio: 1,\n      preview: '.before',\n      background: false,\n      autoCropArea: 0.6,\n      zoomOnWheel: false,\n    })\n    this.setState({\n      myCropper\n    }, () => {\n      this.state.myCropper.replace(this.props.img)\n    })\n  }\n\n  UNSAFE_componentWillReceiveProps(props) {\n    const { img } = props;\n    if (this.props.img !== img) {\n      this.state.myCropper.replace(img)\n    }\n  }\n  render() {\n    const { t, confirm, cancel } = this.props\n    return (\n      <div className='preview_picture'>\n        <div className='preview_left'>\n          <div className=\"show-img\">\n            <img src={this.props.img} ref={this.image} alt=\"\" />\n          </div>\n          <div className='preview_btn'>\n            <span className='confirm' onClick={() => { confirm(this.state.myCropper) }}>{t('Determine')}</span>\n            <span className='cancel' onClick={cancel}>{t('Cancel')}</span>\n          </div>\n        </div>\n        <div className='preview_right'>\n          <p>{t('imagePreview')}</p>\n          <div className=\"before\"></div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default SelectProfilePic;","import React from 'react';\nimport CryptoJS from 'crypto-js';\nimport { Icon, message } from 'antd';\nimport { withTranslation } from 'react-i18next';\nimport i18next from 'i18next';\nimport { wsget, host } from '../../ws';\nimport { ajaxPromise, dataURLtoBlob, getCookie } from '../../util/util';\nimport './style.scss';\nimport SelectProfilePic from './SelectProfilePic';\n\nfunction getBase64(img, callback) {\n  const reader = new FileReader();\n  reader.addEventListener('load', () => callback(reader.result));\n  reader.readAsDataURL(img);\n}\n\n@withTranslation()\nclass Headportrait extends React.Component {\n  constructor(props) {\n    super(props);\n    this.imageRef = React.createRef();\n    this.state = {\n      imageUrl: null\n    }\n  }\n\n  handleChange = (e) => {\n    if (e.target.files.length > 0) {\n      let file = e.target.files[0];\n      if (file.size / 1024 / 1024 > 3) {\n        message.error(i18next.t('Picsize'))\n        return;\n      }\n      getBase64(file, (imageUrl) => {\n        this.setState({ imageUrl, file })\n      })\n    }\n  }\n\n  handleCancel = () => {\n    this.props.handleCancel()\n  }\n\n  handleconfirm = (cropper) => {\n    this.props.handleCancel();\n    const key = 'portrait';\n    message.loading({ content: 'uploading...', key, duration: 0 });\n    const { file } = this.state\n    let afterimg = cropper.getCroppedCanvas({\n      imageSmoothingQuality: 'high'\n    }).toDataURL('image/jpeg');\n    let wordArray = CryptoJS.lib.WordArray.create(afterimg);\n    const hash = CryptoJS.SHA256(wordArray).toString();\n    let blob = dataURLtoBlob(afterimg);\n    ajaxPromise(blob, `${host()}/up/p/${getCookie('cookie')}/${hash}/${file.name}`)\n      .then((result) => {\n        wsget('user_profile_id_save', result.id).then((res) => {\n          message.success({ content: 'succeed!', key, duration: 2 });\n          this.props.callback(null, result.id);\n        }).catch(() => {\n          message.error({ content: 'come to nothing', key, duration: 3 })\n        })\n      })\n  }\n\n  render() {\n    const { imageUrl } = this.state;\n    const { t, handleCancel } = this.props;\n\n    return (\n      <div className='Headportrait-wrap'>\n        <div className='Modify_the_picture'>\n          <span className='close-icon' onClick={handleCancel}>\n            <Icon type=\"close\" />\n          </span>\n          <div className='Modify_head'>\n            {t('Headimage')}\n          </div>\n          <div className='Modify_content'>\n            <p>{t('uploadavatar')}</p>\n            <div className=\"Modify_openimg\">\n              <input type=\"button\" className=\"pass-portrait-filebtn\" name=\"openImgBtn\" id=\"openImgBtn\" value={t('Choosepicture')} />\n              <input\n                type=\"file\"\n                className=\"pass-portrait-file\"\n                accept=\"image/bmp,image/jpeg,image/png\"\n                name=\"file\" id=\"fileImg\"\n                onChange={(e) => { this.handleChange(e) }} />\n              <span className=\"pass-portrait-msg\">{t('SupportPic')}</span>\n            </div>\n\n            {imageUrl && <SelectProfilePic\n              img={this.state.imageUrl}\n              confirm={this.handleconfirm}\n              cancel={this.handleCancel} />}\n\n          </div>\n        </div >\n      </div>\n    );\n  }\n}\nexport default Headportrait;","import React, { Component } from 'react';\nimport { withTranslation } from 'react-i18next';\nimport { Modal, Form, Input } from 'antd';\n\n@withTranslation()\n@Form.create({ name: 'questions' })\nclass Questions extends Component {\n  componentDidMount(){\n    this.props.form.setFieldsValue({\n      text: this.props.val\n    })\n  }\n\n  render() {\n    const { visible, onCancel, onCreate, form, t } = this.props;\n    const { getFieldDecorator } = form;\n    return (\n      <Modal\n        visible={visible}\n        title={t('CustomQuestions')}\n        okText={t('Determine')}\n        onOk={onCreate}\n        onCancel={onCancel}\n        getContainer={false}\n      >\n        <Form.Item label={t(\"securityQuestion\")}>\n            {getFieldDecorator('text', {\n              rules: [\n                { required: true, message: t('enterQuestion'), whitespace: true },\n                { max: 100, message: t('Notmorechar') }\n              ],\n            })(<Input\n              autoComplete=\"off\"\n              placeholder={t('enterQuestion')} />)}\n        </Form.Item>\n      </Modal>\n    );\n  }\n}\n\nexport default Questions;","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { Tooltip, message, Icon } from 'antd';\nimport { Form, Input, Select, Button, Avatar, Divider } from 'antd';\nimport { withTranslation } from 'react-i18next';\nimport { inject, observer } from 'mobx-react';\nimport './style.scss'\nimport { trim, taskStr, storage, reg } from '../../util/util';\nimport { host, wsget } from '../../ws';\nimport Headportrait from '../Headportrait';\nimport Secondhead from '../../common/Secondhead';\nimport Questions from './Questions';\nimport event from '../../util/event';\n\nconst { Option } = Select;\n\n@withTranslation()\n@Form.create({ name: 'perfectinformation' })\n@withRouter\n@inject('login', 'playlist', 'rahmen', 'photoalbum')\n@observer\nclass Perfectinformation extends Component {\n  constructor(props) {\n    super(props);\n    this.nameRef = React.createRef();\n    this.emailRef = React.createRef();\n    this.answerRef = React.createRef();\n    this.customRef = React.createRef();\n    this.t = this.props.t;\n    this.state = {\n      head_visible: false,\n      problemList: [\n        { id: 1, text: this.t('birthday') },\n        { id: 2, text: this.t('yourmind') },\n        { id: 3, text: this.t('favoriteperson') }\n      ],\n      focus: null,\n      profile_id: null,\n      fiag: false,\n      visible: false,\n      user_id: null,\n      show: false,\n      questionVal: ''\n    }\n  }\n\n  componentDidMount() {\n    const userdata = storage.get('user');\n    const { id } = this.props.match.params;\n    if (Number(id) === userdata.id) {\n      this.setState({ user_id: id })\n    } else {\n      storage.remove('user');\n      this.props.history.push(\"/login\");\n    }\n\n    this.avatar = event.on('avatar', (id) => {\n      this.setState({ profile_id: id })\n    })\n  }\n\n  componentWillUnmount() {\n    event.rm(this.avatar)\n  }\n\n  change(e, id) {\n    e.stopPropagation();\n    const { problemList } = this.state;\n    const idx = problemList.findIndex(el => el.id === id);\n    this.setState({ custom: false, checkId: id, problem: problemList[idx].text, pro_visible: false })\n  }\n\n  show = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ pro_visible: true, fiag: true })\n  }\n\n  setCustom = (e) => {\n    // this.setState({custom: true})\n    this.setState({ custom: true, checkId: 0 })\n    setTimeout(() => {\n      this.customRef.current.focus();\n    }, 0);\n  }\n\n  input_focus = (e, txt) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ focus: txt })\n  }\n  input_blur = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ focus: null })\n  }\n\n  headporId = (a, id) => {  //形参a,必须存在\n    event.emit('avatar', id)\n  }\n\n  handleSubmit = e => {\n    e.preventDefault();\n    this.props.form.validateFieldsAndScroll((err, values) => {\n      if (!err) {\n        let data = {\n          nickname: trim(values.nickname),\n          email: values.email,\n          pwd_question: values.question,\n          pwd_answer: values.answer\n        }\n        if (this.state.profile_id) {\n          data.profile_id = this.state.profile_id;\n        }\n        if (this.state.show) {\n          message.error(this.t('boundmail'))\n          return;\n        }\n\n        this.props.login.info_login(data, () => {\n          let user = storage.get('user');\n          const data = {\n            name: user.name,\n            pwd: user.pwd\n          }\n          this.props.login.login_in(data, () => {\n            this.props.history.push(\"/\");\n          })\n        })\n      }\n    });\n  };\n\n  handleCancel = () => {\n    this.setState({ visible: false });\n  };\n\n  handleCreate = () => {\n    const { form } = this.formRef.props;\n    form.validateFields((err, values) => {\n      if (err) {\n        return;\n      }\n      this.props.form.setFieldsValue({\n        question: trim(values.text)\n      })\n      form.resetFields();\n      this.setState({ visible: false });\n    });\n  };\n\n  saveFormRef = formRef => {\n    this.formRef = formRef;\n  };\n\n  getAvatar = () => {\n    return `${host()}/uf/s/${this.state.profile_id}/${this.state.user_id}`\n  }\n\n  addItem = () => {\n    const val = this.props.form.getFieldValue('question') || '';\n    this.setState({\n      questionVal: val,\n      visible: true,\n    });\n  }\n\n  AnswerValidity = (rule, value, callback) => {\n    if (value.length < 2) {\n      return callback(this.props.t('answerValidity'));\n    }\n    if (taskStr(value)) {\n      return callback();\n    }\n    callback(this.props.t('answerValidity'));\n  };\n\n  check_email = (e) => {\n    wsget('user_check_email', e.target.value).then((res) => {\n      this.setState({ show: true })\n    }).catch((res) => {\n      if (res.state === 2) {\n        this.setState({ show: false })\n      }\n    })\n  }\n\n  render() {\n    const { t } = this.props;\n    const { getFieldDecorator } = this.props.form;\n    const {\n      problemList,\n      show,\n      head_visible,\n      profile_id,\n      questionVal } = this.state;\n\n    const check_e = show ? {\n      hasFeedback: true,\n      validateStatus: 'error'\n    } : {};\n\n    return (\n      <div className='perfectinformation-content'>\n        <Secondhead\n          title={t('PerfectInfo')}\n          buyBtn={t('Buyingphotoframes')} />\n        <div className='perfectinformation-inner'>\n          <div className='perfectinformation-head'>\n            <h2>{t('PerfectInfo')}</h2>\n          </div>\n\n          <div className='info_Avatar'>\n            <span className='info_label'>{t('HeadPortrait')}</span>\n            <div className='profile_picture' onClick={() => { this.setState({ head_visible: true }) }}>\n              {profile_id ?\n                <img alt='profile' src={this.getAvatar()} /> :\n                <Avatar size={56} icon=\"user\" />}\n              <Icon className='right-rigth' type=\"right\" />\n            </div>\n          </div>\n\n          <Form layout=\"inline\" onSubmit={this.handleSubmit}>\n            <Form.Item label={t('Nickname')}>\n              <Tooltip\n                placement=\"topLeft\"\n                overlayClassName='tooltip'\n                trigger='focus'\n                title={t('regrule4')}>\n                {getFieldDecorator('nickname', {\n                  rules: [\n                    { required: true, message: t('NicknameEmpty'), whitespace: true },\n                    { pattern: reg.nickname, message: t('nicknameValidity') }\n                  ],\n                })(<Input\n                  autoComplete=\"off\"\n                  size=\"large\"\n                  maxLength={50}\n                  placeholder={t('SetNickname')} />)}\n              </Tooltip>\n            </Form.Item>\n            <Form.Item\n              label={t('mailbox')}\n              {...check_e}\n            >\n              {getFieldDecorator('email', {\n                rules: [\n                  {\n                    pattern: reg.email,\n                    message: 'The input is not valid E-mail!',\n                  },\n                  {\n                    required: true,\n                    message: t('MailboxEmpty'),\n                  }\n                ],\n              })(<Input onBlur={this.check_email} autoComplete=\"off\" size=\"large\" placeholder={t('SetMailbox')} />)}\n            </Form.Item>\n            <Form.Item label={t('securityQuestion')}>\n              {getFieldDecorator('question', {\n                rules: [\n                  {\n                    required: true,\n                    message: t('selectQuestion'),\n                  },\n                ],\n              })(\n                <Select\n                  size=\"large\"\n                  placeholder={t('selectQuestion')}\n                  dropdownRender={menu => (\n                    <div>\n                      {menu}\n                      <Divider style={{ margin: '4px 0' }} />\n                      <div\n                        className='custom-issue'\n                        style={{ padding: '4px 8px', cursor: 'pointer' }}\n                        onMouseDown={e => e.preventDefault()}\n                        onClick={this.addItem}\n                      >\n                        <Icon type=\"plus\" /> {t('CustomQuestions')}\n                      </div>\n                    </div>)}>\n                  {\n                    problemList.map(item => {\n                      return (\n                        <Option key={item.id} value={item.text}>{item.text}</Option>\n                      )\n                    })\n                  }\n                </Select>)}\n            </Form.Item>\n            <Form.Item label={t('Answer')}>\n              <Tooltip\n                placement=\"topLeft\"\n                overlayClassName='tooltip'\n                trigger='focus'\n                title={t('regrule6')}>\n                {getFieldDecorator('answer', {\n                  rules: [\n                    { required: true, message: t('enterAnswer'), whitespace: true }\n                  ],\n                })(<Input\n                  size=\"large\"\n                  maxLength={50}\n                  placeholder={t('enterAnswer')} />)}\n              </Tooltip>\n            </Form.Item>\n            <Form.Item>\n              <Button className='confirm-btn' type=\"primary\" htmlType=\"submit\">{t('Determine')}</Button>\n            </Form.Item>\n          </Form>\n          <span className='hint'>ps:{t('required')}</span>\n\n          {this.state.visible && <Questions\n            wrappedComponentRef={this.saveFormRef}\n            visible={this.state.visible}\n            onCancel={this.handleCancel}\n            onCreate={this.handleCreate}\n            val={questionVal}\n          />}\n        </div>\n\n        {head_visible && <Headportrait\n          callback={this.headporId}\n          handleCancel={() => { this.setState({ head_visible: false }) }} />}\n\n        <div className='l-top'></div>\n        <div className='l-bottom'></div>\n      </div >\n    );\n  }\n}\n\nexport default Perfectinformation;\n"],"sourceRoot":""}