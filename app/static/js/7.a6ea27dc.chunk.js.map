{"version":3,"sources":["components/Perfectinformation/Questions.js","components/Perfectinformation/index.js","components/Headportrait/SelectProfilePic.js","components/Headportrait/index.js"],"names":["Questions","withTranslation","create","name","this","props","form","setFieldsValue","text","val","visible","onCancel","onCreate","t","getFieldDecorator","title","okText","onOk","getContainer","Item","label","rules","required","message","whitespace","max","autoComplete","placeholder","Component","Option","Perfectinformation","inject","withRouter","observer","show","e","nativeEvent","stopImmediatePropagation","setState","pro_visible","fiag","setCustom","custom","checkId","setTimeout","customRef","current","focus","input_focus","txt","input_blur","headporId","_","id","event","emit","handleSubmit","preventDefault","validateFieldsAndScroll","err","values","data","nickname","trim","email","pwd_question","question","pwd_answer","answer","state","profile_id","error","login","info_login","user","storage","get","pwd","login_in","history","push","handleCancel","handleCreate","formRef","validateFields","resetFields","saveFormRef","getAvatar","host","user_id","addItem","getFieldValue","questionVal","AnswerValidity","rule","value","callback","length","taskStr","check_email","wsget","target","then","res","catch","nameRef","React","createRef","emailRef","answerRef","head_visible","problemList","userdata","match","params","Number","remove","avatar","on","rm","stopPropagation","idx","findIndex","el","problem","check_e","hasFeedback","validateStatus","className","Header","buyUrl","xs","span","onClick","alt","src","size","icon","type","labelCol","sm","wrapperCol","onSubmit","placement","overlayClassName","trigger","pattern","reg","maxLength","onBlur","dropdownRender","menu","style","margin","padding","cursor","onMouseDown","map","item","key","offset","htmlType","wrappedComponentRef","Headportrait","SelectProfilePic","image","myCropper","afterImg","Cropper","viewMode","dragMode","initialAspectRatio","aspectRatio","preview","background","autoCropArea","zoomOnWheel","replace","img","confirm","cancel","ref","handleChange","files","file","i18next","reader","FileReader","addEventListener","result","readAsDataURL","getBase64","imageUrl","handleconfirm","cropper","loading","content","duration","afterimg","getCroppedCanvas","imageSmoothingQuality","toDataURL","wordArray","CryptoJS","lib","WordArray","hash","SHA256","toString","blob","dataURLtoBlob","ajaxPromise","getCookie","success","imageRef","accept","onChange"],"mappings":"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","file":"static/js/7.a6ea27dc.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { withTranslation } from 'react-i18next';\nimport { Modal, Form, Input } from 'antd';\n\n@withTranslation()\n@Form.create({ name: 'questions' })\nclass Questions extends Component {\n  componentDidMount(){\n    this.props.form.setFieldsValue({\n      text: this.props.val\n    })\n  }\n\n  render() {\n    const { visible, onCancel, onCreate, form, t } = this.props;\n    const { getFieldDecorator } = form;\n    return (\n      <Modal\n        visible={visible}\n        title={t('CustomQuestions')}\n        okText={t('Determine')}\n        onOk={onCreate}\n        onCancel={onCancel}\n        getContainer={false}\n      >\n        <Form.Item label={t(\"securityQuestion\")}>\n            {getFieldDecorator('text', {\n              rules: [\n                { required: true, message: t('enterQuestion'), whitespace: true },\n                { max: 100, message: t('Notmorechar') }\n              ],\n            })(<Input\n              autoComplete=\"off\"\n              placeholder={t('enterQuestion')} />)}\n        </Form.Item>\n      </Modal>\n    );\n  }\n}\n\nexport default Questions;","import React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { Tooltip, message, Icon, Row, Col } from \"antd\";\nimport { Form, Input, Select, Button, Avatar, Divider } from \"antd\";\nimport { withTranslation } from \"react-i18next\";\nimport { inject, observer } from \"mobx-react\";\nimport \"./style.scss\";\nimport { trim, taskStr, storage, reg } from \"../../util/util\";\nimport { host, wsget } from \"../../ws\";\nimport Headportrait from \"../Headportrait\";\nimport Questions from \"./Questions\";\nimport event from \"../../util/event\";\nimport Header from \"../Header\";\nimport { buyUrl } from \"../../util/url\";\n\nconst { Option } = Select;\n\n@withTranslation()\n@Form.create({ name: \"perfectinformation\" })\n@withRouter\n@inject(\"login\", \"playlist\", \"rahmen\", \"photoalbum\")\n@observer\nclass Perfectinformation extends Component {\n  constructor(props) {\n    super(props);\n    this.nameRef = React.createRef();\n    this.emailRef = React.createRef();\n    this.answerRef = React.createRef();\n    this.customRef = React.createRef();\n    this.t = this.props.t;\n    this.state = {\n      head_visible: false,\n      problemList: [\n        { id: 1, text: this.t(\"birthday\") },\n        { id: 2, text: this.t(\"yourmind\") },\n        { id: 3, text: this.t(\"favoriteperson\") },\n      ],\n      focus: null,\n      profile_id: null,\n      fiag: false,\n      visible: false,\n      user_id: null,\n      show: false,\n      questionVal: \"\",\n    };\n  }\n\n  componentDidMount() {\n    const userdata = storage.get(\"user\");\n    const { id } = this.props.match.params;\n    if (Number(id) === userdata.id) {\n      this.setState({ user_id: id });\n    } else {\n      if (storage.get(\"user\")) {\n        wsget(\"user_logout\", null);\n      }\n      storage.remove(\"user\");\n      this.props.history.push(\"/login\");\n    }\n\n    this.avatar = event.on(\"avatar\", (id) => {\n      this.setState({ profile_id: id });\n    });\n  }\n\n  componentWillUnmount() {\n    event.rm(this.avatar);\n  }\n\n  change(e, id) {\n    e.stopPropagation();\n    const { problemList } = this.state;\n    const idx = problemList.findIndex((el) => el.id === id);\n    this.setState({\n      custom: false,\n      checkId: id,\n      problem: problemList[idx].text,\n      pro_visible: false,\n    });\n  }\n\n  show = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ pro_visible: true, fiag: true });\n  };\n\n  setCustom = (e) => {\n    // this.setState({custom: true})\n    this.setState({ custom: true, checkId: 0 });\n    setTimeout(() => {\n      this.customRef.current.focus();\n    }, 0);\n  };\n\n  input_focus = (e, txt) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ focus: txt });\n  };\n  input_blur = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.setState({ focus: null });\n  };\n\n  headporId = (_, id) => {\n    event.emit(\"avatar\", id);\n  };\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n    this.props.form.validateFieldsAndScroll((err, values) => {\n      console.log(values, \"kkkkkkkkk\");\n      if (!err) {\n        let data = {\n          nickname: trim(values.nickname),\n          email: values.email,\n          pwd_question: values.question,\n          pwd_answer: values.answer,\n        };\n        if (this.state.profile_id) {\n          data.profile_id = this.state.profile_id;\n        }\n        if (this.state.show) {\n          message.error(this.t(\"boundmail\"));\n          return;\n        }\n\n        this.props.login.info_login(data, () => {\n          let user = storage.get(\"user\");\n          const data = {\n            name: user.name,\n            pwd: user.pwd,\n          };\n          this.props.login.login_in(data, () => {\n            this.props.history.push(\"/\");\n          });\n        });\n      }\n    });\n  };\n\n  handleCancel = () => {\n    this.setState({ visible: false });\n  };\n\n  handleCreate = () => {\n    const { form } = this.formRef.props;\n    form.validateFields((err, values) => {\n      if (err) {\n        return;\n      }\n      this.props.form.setFieldsValue({\n        question: trim(values.text),\n      });\n      form.resetFields();\n      this.setState({ visible: false });\n    });\n  };\n\n  saveFormRef = (formRef) => {\n    this.formRef = formRef;\n  };\n\n  getAvatar = () => {\n    return `${host()}/uf/s/${this.state.profile_id}/${this.state.user_id}`;\n  };\n\n  addItem = () => {\n    const val = this.props.form.getFieldValue(\"question\") || \"\";\n    this.setState({\n      questionVal: val,\n      visible: true,\n    });\n  };\n\n  AnswerValidity = (rule, value, callback) => {\n    if (value.length < 2) {\n      return callback(this.props.t(\"answerValidity\"));\n    }\n    if (taskStr(value)) {\n      return callback();\n    }\n    callback(this.props.t(\"answerValidity\"));\n  };\n\n  check_email = (e) => {\n    wsget(\"user_check_email\", e.target.value)\n      .then((res) => {\n        this.setState({ show: true });\n      })\n      .catch((res) => {\n        if (res.state === 2) {\n          this.setState({ show: false });\n        }\n      });\n  };\n\n  render() {\n    const { t } = this.props;\n    const { getFieldDecorator } = this.props.form;\n    const {\n      problemList,\n      show,\n      head_visible,\n      profile_id,\n      questionVal,\n    } = this.state;\n\n    const check_e = show\n      ? {\n          hasFeedback: true,\n          validateStatus: \"error\",\n        }\n      : {};\n\n    const formItemLayout = {\n      labelCol: {\n        xs: { span: 24 },\n        sm: { span: 8 },\n      },\n      wrapperCol: {\n        xs: { span: 24 },\n        sm: { span: 16 },\n      },\n    };\n\n    const tailFormItemLayout = {\n      wrapperCol: {\n        xs: {\n          span: 24,\n          offset: 0,\n        },\n        sm: {\n          span: 16,\n          offset: 8,\n        },\n      },\n    };\n\n    return (\n      <div className=\"perfectinformation-content\">\n        <Header buyUrl={buyUrl} title={t(\"PerfectInfo\")} />\n        <div className=\"perfectinformation-inner\">\n          <div className=\"perfectinformation-head\">\n            <h2>{t(\"PerfectInfo\")}</h2>\n            <span className=\"hint\">ps:{t(\"required\")}</span>\n          </div>\n\n          <Row className=\"info_Avatar\">\n            <Col xs={{ span: 6 }}>\n              <span className=\"info_label\">{t(\"HeadPortrait\")}:</span>\n            </Col>\n            <Col xs={{ span: 18 }}>\n              <div\n                className=\"profile_picture\"\n                onClick={() => {\n                  this.setState({ head_visible: true });\n                }}\n              >\n                {profile_id ? (\n                  <img alt=\"profile\" src={this.getAvatar()} />\n                ) : (\n                  <Avatar size={56} icon=\"user\" />\n                )}\n                <Icon className=\"right-rigth\" type=\"right\" />\n              </div>\n            </Col>\n          </Row>\n\n          <Form {...formItemLayout} onSubmit={this.handleSubmit}>\n            <Form.Item label={t(\"Nickname\")}>\n              <Tooltip\n                placement=\"topLeft\"\n                overlayClassName=\"tooltip\"\n                trigger=\"focus\"\n                title={t(\"regrule4\")}\n              >\n                {getFieldDecorator(\"nickname\", {\n                  rules: [\n                    {\n                      required: true,\n                      message: t(\"NicknameEmpty\"),\n                      whitespace: true,\n                    },\n                    { pattern: reg.nickname, message: t(\"nicknameValidity\") },\n                  ],\n                })(\n                  <Input\n                    autoComplete=\"off\"\n                    size=\"large\"\n                    maxLength={50}\n                    placeholder={t(\"SetNickname\")}\n                  />\n                )}\n              </Tooltip>\n            </Form.Item>\n\n            <Form.Item label={t(\"mailbox\")} {...check_e}>\n              {getFieldDecorator(\"email\", {\n                rules: [\n                  {\n                    pattern: reg.email,\n                    message: \"The input is not valid E-mail!\",\n                  },\n                  {\n                    required: true,\n                    message: t(\"MailboxEmpty\"),\n                  },\n                ],\n              })(\n                <Input\n                  onBlur={this.check_email}\n                  autoComplete=\"off\"\n                  size=\"large\"\n                  placeholder={t(\"SetMailbox\")}\n                />\n              )}\n            </Form.Item>\n            <Form.Item label={t(\"securityQuestion\")}>\n              {getFieldDecorator(\"question\", {\n                rules: [\n                  {\n                    required: true,\n                    message: t(\"selectQuestion\"),\n                  },\n                ],\n              })(\n                <Select\n                  size=\"large\"\n                  placeholder={t(\"selectQuestion\")}\n                  dropdownRender={(menu) => (\n                    <div>\n                      {menu}\n                      <Divider style={{ margin: \"4px 0\" }} />\n                      <div\n                        className=\"custom-issue\"\n                        style={{ padding: \"4px 8px\", cursor: \"pointer\" }}\n                        onMouseDown={(e) => e.preventDefault()}\n                        onClick={this.addItem}\n                      >\n                        <Icon type=\"plus\" /> {t(\"CustomQuestions\")}\n                      </div>\n                    </div>\n                  )}\n                >\n                  {problemList.map((item) => {\n                    return (\n                      <Option key={item.id} value={item.text}>\n                        {item.text}\n                      </Option>\n                    );\n                  })}\n                </Select>\n              )}\n            </Form.Item>\n            <Form.Item label={t(\"Answer\")}>\n              <Tooltip\n                placement=\"topLeft\"\n                overlayClassName=\"tooltip\"\n                trigger=\"focus\"\n                title={t(\"regrule6\")}\n              >\n                {getFieldDecorator(\"answer\", {\n                  rules: [\n                    {\n                      required: true,\n                      message: t(\"enterAnswer\"),\n                      whitespace: true,\n                    },\n                  ],\n                })(\n                  <Input\n                    size=\"large\"\n                    maxLength={50}\n                    placeholder={t(\"enterAnswer\")}\n                  />\n                )}\n              </Tooltip>\n            </Form.Item>\n            <Form.Item {...tailFormItemLayout}>\n              <Button className=\"confirm-btn\" type=\"primary\" htmlType=\"submit\">\n                {t(\"Determine\")}\n              </Button>\n            </Form.Item>\n          </Form>\n\n          {this.state.visible && (\n            <Questions\n              wrappedComponentRef={this.saveFormRef}\n              visible={this.state.visible}\n              onCancel={this.handleCancel}\n              onCreate={this.handleCreate}\n              val={questionVal}\n            />\n          )}\n        </div>\n\n        {head_visible && (\n          <Headportrait\n            callback={this.headporId}\n            handleCancel={() => {\n              this.setState({ head_visible: false });\n            }}\n          />\n        )}\n\n        <div className=\"l-top\"></div>\n        <div className=\"l-bottom\"></div>\n      </div>\n    );\n  }\n}\n\nexport default Perfectinformation;\n","import React from 'react';\nimport Cropper from 'cropperjs'\nimport { withTranslation } from 'react-i18next';\nimport 'cropperjs/dist/cropper.css'\n\n@withTranslation()\nclass SelectProfilePic extends React.Component {\n  constructor(props) {\n    super(props);\n    this.image = React.createRef();\n    this.state = {\n      myCropper: null,\n      afterImg: ''\n    }\n  }\n\n  componentDidMount() {\n    let myCropper = new Cropper(this.image.current, {\n      viewMode: 1,\n      dragMode: 'none',\n      initialAspectRatio: 1,\n      aspectRatio: 1,\n      preview: '.before',\n      background: false,\n      autoCropArea: 0.6,\n      zoomOnWheel: false,\n    })\n    this.setState({\n      myCropper\n    }, () => {\n      this.state.myCropper.replace(this.props.img)\n    })\n  }\n\n  UNSAFE_componentWillReceiveProps(props) {\n    const { img } = props;\n    if (this.props.img !== img) {\n      this.state.myCropper.replace(img)\n    }\n  }\n  render() {\n    const { t, confirm, cancel } = this.props\n    return (\n      <div className='preview_picture'>\n        <div className='preview_left'>\n          <div className=\"show-img\">\n            <img src={this.props.img} ref={this.image} alt=\"\" />\n          </div>\n          <div className='preview_btn'>\n            <span className='confirm' onClick={() => { confirm(this.state.myCropper) }}>{t('Determine')}</span>\n            <span className='cancel' onClick={cancel}>{t('Cancel')}</span>\n          </div>\n        </div>\n        <div className='preview_right'>\n          <p>{t('imagePreview')}</p>\n          <div className=\"before\"></div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default SelectProfilePic;","import React from 'react';\nimport CryptoJS from 'crypto-js';\nimport { Icon, message } from 'antd';\nimport { withTranslation } from 'react-i18next';\nimport i18next from 'i18next';\nimport { wsget, host } from '../../ws';\nimport { ajaxPromise, dataURLtoBlob, getCookie } from '../../util/util';\nimport './style.scss';\nimport SelectProfilePic from './SelectProfilePic';\n\nfunction getBase64(img, callback) {\n  const reader = new FileReader();\n  reader.addEventListener('load', () => callback(reader.result));\n  reader.readAsDataURL(img);\n}\n\n@withTranslation()\nclass Headportrait extends React.Component {\n  constructor(props) {\n    super(props);\n    this.imageRef = React.createRef();\n    this.state = {\n      imageUrl: null\n    }\n  }\n\n  handleChange = (e) => {\n    if (e.target.files.length > 0) {\n      let file = e.target.files[0];\n      if (file.size / 1024 / 1024 > 3) {\n        message.error(i18next.t('Picsize'))\n        return;\n      }\n      getBase64(file, (imageUrl) => {\n        this.setState({ imageUrl, file })\n      })\n    }\n  }\n\n  handleCancel = () => {\n    this.props.handleCancel()\n  }\n\n  handleconfirm = (cropper) => {\n    this.props.handleCancel();\n    const key = 'portrait';\n    message.loading({ content: 'uploading...', key, duration: 0 });\n    const { file } = this.state\n    let afterimg = cropper.getCroppedCanvas({\n      imageSmoothingQuality: 'high'\n    }).toDataURL('image/jpeg');\n    let wordArray = CryptoJS.lib.WordArray.create(afterimg);\n    const hash = CryptoJS.SHA256(wordArray).toString();\n    let blob = dataURLtoBlob(afterimg);\n    ajaxPromise(blob, `${host()}/up/p/${getCookie('cookie')}/${hash}/${file.name}`)\n      .then((result) => {\n        wsget('user_profile_id_save', result.id).then((res) => {\n          message.success({ content: 'succeed!', key, duration: 2 });\n          this.props.callback(null, result.id);\n        }).catch(() => {\n          message.error({ content: 'come to nothing', key, duration: 3 })\n        })\n      })\n  }\n\n  render() {\n    const { imageUrl } = this.state;\n    const { t, handleCancel } = this.props;\n\n    return (\n      <div className='Headportrait-wrap'>\n        <div className='Modify_the_picture'>\n          <span className='close-icon' onClick={handleCancel}>\n            <Icon type=\"close\" />\n          </span>\n          <div className='Modify_head'>\n            {t('Headimage')}\n          </div>\n          <div className='Modify_content'>\n            <p>{t('uploadavatar')}</p>\n            <div className=\"Modify_openimg\">\n              <input type=\"button\" className=\"pass-portrait-filebtn\" name=\"openImgBtn\" id=\"openImgBtn\" value={t('Choosepicture')} />\n              <input\n                type=\"file\"\n                className=\"pass-portrait-file\"\n                accept=\"image/bmp,image/jpeg,image/png\"\n                name=\"file\" id=\"fileImg\"\n                onChange={(e) => { this.handleChange(e) }} />\n              <span className=\"pass-portrait-msg\">{t('SupportPic')}</span>\n            </div>\n\n            {imageUrl && <SelectProfilePic\n              img={this.state.imageUrl}\n              confirm={this.handleconfirm}\n              cancel={this.handleCancel} />}\n\n          </div>\n        </div >\n      </div>\n    );\n  }\n}\nexport default Headportrait;"],"sourceRoot":""}