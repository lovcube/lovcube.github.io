{"version":3,"sources":["components/Feedback/NewFeedback.js","components/Feedback/index.js","components/Feedback/style.module.scss"],"names":["getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","NewFeedback","props","previewHandleCancel","e","setState","previewVisible","handlePreview","a","async","url","preview","originFileObj","previewImage","handleChange","fileList","obj","changeHash","quality","hash","host","getCookie","data","name","uploadImg","action","state","imgItem","uid","status","percent","upLoading","ajaxPromise","getFile","file_s","id","visible","message","i18next","t","Ok","attach","subject","add","inputRef","current","value","trim","msg","textareaRef","length","forEach","item","push","warning","handleOk","Cancel","handleCancel","React","createRef","this","confirmLoading","uploadButton","type","centered","title","onOk","onCancel","destroyOnClose","footer","key","disabled","loading","onClick","className","styles","fb_block","fb_lable","fb_tips","fb_title_tips","fb_textarea","placeholder","maxLength","ref","fb_lable1","accept","customRequest","listType","onPreview","onChange","bodyStyle","textAlign","alt","style","maxWidth","maxHeight","src","PureComponent","Feedback","withTranslation","inject","observer","resize","window","innerWidth","inner","showModal","cb","feedback","wsget","then","res","refreshtDetail","finally","closeDialog","bImg_visible","files","onPiece","imgidx","onBigImg","nextPage","i","realNum","img","imgfile","imgLoad","file_b","back","ulRef","boxRef","avatar","getData","err","NO_CONNECT","history","addEventListener","login","getUser_detail","removeEventListener","init","listData","detail","detailInit","empty","created","getDetail","user_id","feedback_inner","height","xs","span","sm","md","lg","xl","feedback_right","Nodata","feedback_right_inner","feedback_r_head","r_head_title","r_head_bottom","dayjs","format","r_bottom_body","map","detailList","list","profile","icon","unread","el","feedback_s","bottom_btn","Loading","feedback_left","feedback_l_head","placement","feedback_l_body","l_listcell","l_active","count","ImageGallery","cpt","ext","Component","observable","module","exports"],"mappings":"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","file":"static/js/25.a1c3336f.chunk.js","sourcesContent":["import React, { PureComponent } from \"react\";\nimport { Modal, Button, Upload, Icon, message } from \"antd\";\nimport styles from \"./style.module.scss\";\nimport { changeHash, ajaxPromise, getCookie, getFile } from \"../../util/index\";\nimport { host } from \"../../ws\";\nimport i18next from \"i18next\";\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = (error) => reject(error);\n  });\n}\n\nexport default class NewFeedback extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.textareaRef = React.createRef();\n    this.inputRef = React.createRef();\n    this.state = {\n      previewVisible: false,\n      previewImage: \"\",\n      fileList: [],\n      upLoading: false,\n    };\n  }\n\n  previewHandleCancel = (e) => {\n    this.setState({ previewVisible: false });\n  };\n\n  handlePreview = async (file) => {\n    if (!file.url && !file.preview) {\n      file.preview = await getBase64(file.originFileObj);\n    }\n\n    this.setState({\n      previewImage: file.url || file.preview,\n      previewVisible: true,\n    });\n  };\n\n  handleChange = ({ fileList }) => this.setState({ fileList });\n\n  url = (file) => {\n    const obj = { file };\n    return new Promise(async (resolve, reject) => {\n      try {\n        const hash = await changeHash(obj, { quality: 0.7 }, 2048, 2048);\n        const url = `${host()}/up/p/${getCookie(\"lovtok\")}/${hash.data.hash}/${\n          file.name\n        }`;\n        resolve(url);\n      } catch (error) {\n        reject(error);\n      }\n    });\n  };\n\n  uploadImg = async ({ file, action }) => {\n    const { fileList } = this.state;\n    const imgItem = {\n      uid: file.uid, // 注意，这个uid一定不能少，否则上传失败\n      name: \"hehe.png\",\n      status: \"uploading\",\n      url: \"\",\n      percent: 50, // 注意不要写100。100表示上传完成\n    };\n    this.setState({\n      fileList: [...fileList, imgItem],\n      upLoading: true,\n    });\n    try {\n      const data = await ajaxPromise(file, action);\n      const imgItem = {\n        uid: file.uid, // 注意，这个uid一定不能少，否则上传失败\n        name: file.name,\n        status: \"done\",\n        url: getFile.file_s(data.id),\n        id: data.id,\n      };\n      if (this.props.visible) {\n        this.setState({\n          fileList: [...fileList, imgItem],\n          upLoading: false,\n        });\n      }\n    } catch (error) {\n      message.error(i18next.t(\"feebfaid\"));\n      this.setState({\n        upLoading: false,\n      });\n    }\n  };\n\n  Ok = () => {\n    let data;\n    const attach = [];\n    const subject = this.props.add ? this.inputRef.current.value.trim() : true;\n    const msg = this.textareaRef.current.value.trim();\n    if (!subject) {\n      message.error(i18next.t(\"feedWarning1\"));\n      return;\n    }\n    if (!msg) {\n      message.error(i18next.t(\"feedWarning2\"));\n      return;\n    }\n    if (this.props.add) {\n      data = {\n        subject,\n        message: msg,\n      };\n    } else {\n      data = {\n        message: msg,\n      };\n    }\n\n    if (this.state.fileList.length) {\n      this.state.fileList.forEach((item) => {\n        attach.push(item.id);\n      });\n      data.attach = attach;\n    }\n    if (this.state.upLoading) {\n      message.warning(i18next.t(\"feedWarning3\"));\n    } else {\n      this.props.handleOk(data, this.Cancel);\n    }\n  };\n\n  handleCancel = (e) => {\n    this.props.handleCancel(this.Cancel);\n  };\n\n  Cancel = () => {\n    this.textareaRef.current.value = \"\";\n    this.setState({\n      fileList: [],\n      upLoading: false,\n    });\n  };\n\n  render() {\n    const { visible, add, confirmLoading } = this.props;\n    const { previewVisible, previewImage, fileList, upLoading } = this.state;\n    const uploadButton = (\n      <div>\n        <Icon type=\"plus\" />\n      </div>\n    );\n    return (\n      <Modal\n        centered\n        title={i18next.t(\"ProblemFeedback\")}\n        visible={visible}\n        onOk={this.Ok}\n        onCancel={this.handleCancel}\n        destroyOnClose={true}\n        footer={\n          add ? (\n            <Button\n              key=\"submit\"\n              type=\"primary\"\n              disabled={upLoading}\n              loading={confirmLoading}\n              onClick={this.Ok}\n            >\n              {i18next.t(\"Submit\")}\n            </Button>\n          ) : (\n            <Button\n              key=\"submit\"\n              type=\"primary\"\n              disabled={upLoading}\n              loading={confirmLoading}\n              onClick={this.Ok}\n            >\n              {i18next.t(\"reply\")}\n            </Button>\n          )\n        }\n      >\n        {add && (\n          <div className={`${styles.fb_block} clearfix`}>\n            <div className={styles.fb_lable}>\n              <span className={styles.fb_tips}>*</span>\n              <span className={styles.fb_title_tips}>Title:</span>\n            </div>\n            <div className={styles.fb_textarea}>\n              <input\n                placeholder={i18next.t(\"enterTitle\")}\n                maxLength={250}\n                type=\"text\"\n                ref={this.inputRef}\n              />\n            </div>\n          </div>\n        )}\n        <div className={`${styles.fb_block} clearfix`}>\n          <div className={styles.fb_lable}>\n            <span className={styles.fb_tips}>*</span>\n            <span className={styles.fb_title_tips}>Message:</span>\n          </div>\n          <div className={styles.fb_textarea}>\n            <textarea\n              name=\"content\"\n              id=\"fb_des_content\"\n              placeholder={i18next.t(\"enterDdescription\")}\n              maxLength={1000}\n              ref={this.textareaRef}\n            ></textarea>\n          </div>\n        </div>\n\n        <div className={`${styles.fb_block} clearfix`}>\n          <div className={styles.fb_lable1}>\n            <span className={styles.fb_title_tips}>\n              Attach: ({i18next.t(\"Upto10\")})\n            </span>\n          </div>\n          <div className={`clearfix`}>\n            <Upload\n              action={this.url}\n              accept=\"image/bmp,image/gif,image/jpeg,image/png\"\n              customRequest={this.uploadImg}\n              listType=\"picture-card\"\n              fileList={fileList}\n              onPreview={this.handlePreview}\n              onChange={this.handleChange}\n            >\n              {fileList.length >= 10 ? null : uploadButton}\n            </Upload>\n            <Modal\n              visible={previewVisible}\n              footer={null}\n              bodyStyle={{textAlign:'center'}}\n              onCancel={this.previewHandleCancel}\n              centered\n            >\n              <img\n                alt=\"example\"\n                style={{ maxWidth: \"80vw\", maxHeight: \"70vh\" }}\n                src={previewImage}\n              />\n            </Modal>\n          </div>\n        </div>\n      </Modal>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { withTranslation } from \"react-i18next\";\nimport { inject, observer } from \"mobx-react\";\nimport styles from \"./style.module.scss\";\nimport Loading from \"../../common/Widget/Loading\";\nimport Nodata from \"../../common/Widget/Nodata\";\nimport { Icon, Tooltip, Avatar, message, Badge, Col, Row } from \"antd\";\nimport dayjs from \"dayjs\";\nimport { getFile, imgLoad } from \"../../util/index\";\nimport { host, wsget } from \"../../ws\";\nimport NewFeedback from \"./NewFeedback\";\nimport { observable } from \"mobx\";\nimport ImageGallery from \"../../common/ImageGallery\";\nimport { NO_CONNECT } from '../../util/wsmq'\n\n@withTranslation()\n@inject(\"feedback\", \"login\")\n@observer\nclass Feedback extends Component {\n  constructor(props) {\n    super(props);\n    this.ulRef = React.createRef();\n    this.boxRef = React.createRef();\n    this.state = {\n      avatar: false,\n      add: null,\n      confirmLoading: false,\n      bImg_visible: false,\n      imgfile: {},\n      files: null,\n    };\n  }\n  @observable inner = false;\n  @observable visible = false;\n\n  componentDidMount() {\n    this.props.feedback.getData((err)=>{\n      if(err.state === NO_CONNECT){\n        this.props.history.push(\"/\");\n      }\n    });\n    this.resize();\n    window.addEventListener(\"resize\", this.resize);\n  }\n\n  componentWillUnmount() {\n    this.props.login.getUser_detail();\n    window.removeEventListener(\"resize\", this.resize);\n  }\n\n  resize = () => {\n    if (window.innerWidth < 576) {\n      if (!this.inner) {\n        this.inner = true;\n      }\n    } else {\n      if (this.inner) {\n        this.inner = false;\n        this.visible = false;\n      }\n    }\n  };\n\n  showModal = (add) => {\n    this.setState({\n      visible: true,\n      add,\n    });\n  };\n\n  handleOk = (data, cb) => {\n    this.setState({\n      confirmLoading: true,\n    });\n    if (!this.state.add) {\n      data.id = this.props.feedback.id;\n    }\n    wsget(\"feedback_save\", data, 1)\n      .then((res) => {\n        this.props.feedback.refreshtDetail(res);\n      })\n      .finally(() => {\n        this.setState({\n          visible: false,\n          confirmLoading: false,\n        });\n        cb && cb();\n      });\n  };\n\n  handleCancel = (cb) => {\n    this.setState({\n      add: null,\n      visible: false,\n    });\n    cb && cb();\n  };\n\n  closeDialog = () => {\n    this.setState({\n      bImg_visible: false,\n      files: null,\n    });\n  };\n\n  onPiece = () => {\n    if (this.imgidx - 1 >= 0) {\n      this.onBigImg(this.state.files, this.imgidx - 1);\n    } else {\n      this.imgidx = this.state.files.length - 1;\n      this.onBigImg(this.state.files, this.imgidx);\n      message.warning(this.props.t(\"lastOne\"));\n    }\n  };\n\n  nextPage = () => {\n    if (this.imgidx + 1 >= this.state.files.length) {\n      this.imgidx = 0;\n      this.onBigImg(this.state.files, this.imgidx);\n      message.warning(this.props.t(\"firstOne\"));\n      return;\n    }\n    this.onBigImg(this.state.files, this.imgidx + 1);\n  };\n\n  onBigImg = (files, i) => {\n    const realNum = files.length;\n    const img = { id: files[i] };\n    this.imgidx = i;\n    this.setState({ bImg_visible: true, imgfile: img, files });\n    if (i + 1 < realNum) {\n      imgLoad(getFile.file_b(files[i + 1]));\n    }\n    if (!(i - 1 < 0)) {\n      imgLoad(getFile.file_b(files[i - 1]));\n    }\n  };\n\n  back = () => {\n    this.visible = false;\n  };\n\n  render() {\n    const {\n      init,\n      id,\n      listData,\n      detail,\n      detailInit,\n      empty,\n      subject,\n      created,\n      getDetail,\n      user_id,\n    } = this.props.feedback;\n    const { t } = this.props;\n    const { visible, add, confirmLoading, bImg_visible, imgfile } = this.state;\n\n    return (\n      <div className={styles.feedback_inner}>\n        {init ? (\n          <Row style={{ height: \"100%\" }}>\n            <Col\n              xs={{ span: 24 }}\n              sm={{ span: 9 }}\n              md={{ span: 8 }}\n              lg={{ span: 6 }}\n              xl={{ span: 5 }}\n              style={{ height: \"100%\" }}\n            >\n              {this.visible ? (\n                <div className={styles.feedback_right}>\n                  {detailInit ? (\n                    empty ? (\n                      <Nodata />\n                    ) : (\n                      <div className={styles.feedback_right_inner}>\n                        <div className={styles.feedback_r_head}>\n                          <p\n                            className={`${styles.r_head_title} ellipsis`}\n                            onClick={this.back}\n                          >\n                            <Icon type=\"left\" />\n                            {subject}\n                          </p>\n                          <p className={styles.r_head_bottom}>\n                            <span>id: {id}</span>\n                            <span>{dayjs(created).format(t(\"LL\"))}</span>\n                          </p>\n                        </div>\n                        <div className={styles.r_bottom_body} ref={this.boxRef}>\n                          <ul ref={this.ulRef}>\n                            {detail.map((item, i) => {\n                              return (\n                                <li key={i} className={styles.detailList}>\n                                  {item.user_id === user_id ? (\n                                    <p className={styles.list}>\n                                      <span>\n                                        {dayjs(item.created).format(t(\"LL\"))}\n                                      </span>\n                                      <span>\n                                        {t(\"me\")}&nbsp;&nbsp;\n                                        {item.profile ? (\n                                          <Avatar\n                                            src={`${host()}/uf/s/${item.profile.id\n                                              }/${item.user_id}`}\n                                          />\n                                        ) : (\n                                            <Avatar icon=\"user\" />\n                                          )}\n                                      </span>\n                                    </p>\n                                  ) : (\n                                    <p className={styles.list}>\n                                      <span>\n                                        {item.unread && (\n                                          <Badge status=\"error\" />\n                                        )}\n                                        {t(\"Admin\")}&nbsp;&nbsp;\n                                        {item.profile ? (\n                                          <Avatar\n                                            src={`${host()}/uf/s/${\n                                              item.profile.id\n                                            }/${item.user_id}`}\n                                          />\n                                        ) : (\n                                          <Avatar icon=\"user\" />\n                                        )}\n                                      </span>\n                                      <span>\n                                        {dayjs(item.created).format(t(\"LL\"))}\n                                      </span>\n                                    </p>\n                                  )}\n                                  <p>{item.message}</p>\n                                  {item.attach && (\n                                    <div className={styles.attach}>\n                                      <ul>\n                                        {item.attach.map((el, i) => {\n                                          return (\n                                            <li\n                                              key={el}\n                                              onClick={() => {\n                                                this.onBigImg(item.attach, i);\n                                              }}\n                                            >\n                                              <img\n                                                src={\n                                                  item.user_id === user_id\n                                                    ? getFile.file_s(el)\n                                                    : getFile.feedback_s(\n                                                        el,\n                                                        item.user_id\n                                                      )\n                                                }\n                                                alt=\"\"\n                                              />\n                                            </li>\n                                          );\n                                        })}\n                                      </ul>\n                                    </div>\n                                  )}\n                                </li>\n                              );\n                            })}\n                          </ul>\n                        </div>\n                        <div\n                          className={styles.bottom_btn}\n                          onClick={() => {\n                            this.showModal(null);\n                          }}\n                        >\n                          <Icon type=\"message\" />\n                          {t(\"reply\")}\n                        </div>\n                      </div>\n                    )\n                  ) : (\n                    <Loading />\n                  )}\n                </div>\n              ) : (\n                <div className={styles.feedback_left}>\n                  <div className={styles.feedback_l_head}>\n                    <span>{t(\"FeedbackHistory\")}</span>\n                    <Tooltip placement=\"bottom\" title={t(\"addFeedback\")}>\n                      <Icon\n                        type=\"plus\"\n                        onClick={() => {\n                          this.showModal(\"add\");\n                        }}\n                      />\n                    </Tooltip>\n                  </div>\n                  <div className={styles.feedback_l_body}>\n                    <ul>\n                      {listData.map((item) => {\n                        return (\n                          <li\n                            className={`${styles.l_listcell} ${\n                              id === item.id ? styles.l_active : \"\"\n                            }`}\n                            key={item.id}\n                            onClick={() => {\n                              if (this.inner) {\n                                this.visible = true;\n                                getDetail(item);\n                              } else {\n                                getDetail(item);\n                              }\n                            }}\n                          >\n                            <div className={styles.subject}>\n                              <Badge count={item.unread} />\n                              {item.subject}\n                            </div>\n                            <p className={styles.message}>{item.message}</p>\n                            <p className={styles.created}>\n                              {dayjs(item.created).format(t(\"LL\"))}\n                            </p>\n                          </li>\n                        );\n                      })}\n                    </ul>\n                  </div>\n                </div>\n              )}\n            </Col>\n            <Col\n              xs={{ span: 0 }}\n              sm={{ span: 15 }}\n              md={{ span: 16 }}\n              lg={{ span: 18 }}\n              xl={{ span: 19 }}\n              style={{ height: \"100%\" }}\n            >\n              <div className={styles.feedback_right}>\n                {detailInit ? (\n                  empty ? (\n                    <Nodata />\n                  ) : (\n                    <div className={styles.feedback_right_inner}>\n                      <div className={styles.feedback_r_head}>\n                        <p className={`${styles.r_head_title} ellipsis`}>\n                          {subject}\n                        </p>\n                        <p className={styles.r_head_bottom}>\n                          <span>id: {id}</span>\n                          <span>{dayjs(created).format(t(\"LL\"))}</span>\n                        </p>\n                      </div>\n                      <div className={styles.r_bottom_body} ref={this.boxRef}>\n                        <ul ref={this.ulRef}>\n                          {detail.map((item, i) => {\n                            return (\n                              <li key={i} className={styles.detailList}>\n                                {item.user_id === user_id ? (\n                                  <p className={styles.list}>\n                                    <span>\n                                      {dayjs(item.created).format(t(\"LL\"))}\n                                    </span>\n                                    <span>\n                                      {t(\"me\")}&nbsp;&nbsp;\n                                      {item.profile ? (\n                                        <Avatar\n                                          src={`${host()}/uf/s/${\n                                            item.profile.id\n                                          }/${item.user_id}`}\n                                        />\n                                      ) : (\n                                        <Avatar icon=\"user\" />\n                                      )}\n                                    </span>\n                                  </p>\n                                ) : (\n                                  <p className={styles.list}>\n                                    <span>\n                                      {item.unread && <Badge status=\"error\" />}\n                                      {t(\"Admin\")}&nbsp;&nbsp;\n                                      {item.profile ? (\n                                        <Avatar\n                                          src={`${host()}/uf/s/${\n                                            item.profile.id\n                                          }/${item.user_id}`}\n                                        />\n                                      ) : (\n                                        <Avatar icon=\"user\" />\n                                      )}\n                                    </span>\n                                    <span>\n                                      {dayjs(item.created).format(t(\"LL\"))}\n                                    </span>\n                                  </p>\n                                )}\n                                <p>{item.message}</p>\n                                {item.attach && (\n                                  <div className={styles.attach}>\n                                    <ul>\n                                      {item.attach.map((el, i) => {\n                                        return (\n                                          <li\n                                            key={el}\n                                            onClick={() => {\n                                              this.onBigImg(item.attach, i);\n                                            }}\n                                          >\n                                            <img\n                                              src={\n                                                item.user_id === user_id\n                                                  ? getFile.file_s(el)\n                                                  : getFile.feedback_s(\n                                                      el,\n                                                      item.user_id\n                                                    )\n                                              }\n                                              alt=\"\"\n                                            />\n                                          </li>\n                                        );\n                                      })}\n                                    </ul>\n                                  </div>\n                                )}\n                              </li>\n                            );\n                          })}\n                        </ul>\n                      </div>\n                      <div\n                        className={styles.bottom_btn}\n                        onClick={() => {\n                          this.showModal(null);\n                        }}\n                      >\n                        <Icon type=\"message\" />\n                        {t('reply')}\n                      </div>\n                    </div>\n                  )\n                ) : (\n                  <Loading />\n                )}\n              </div>\n            </Col>\n          </Row>\n        ) : (\n          <Loading />\n        )}\n\n        <NewFeedback\n          visible={visible}\n          add={add}\n          handleOk={this.handleOk}\n          confirmLoading={confirmLoading}\n          handleCancel={this.handleCancel}\n        />\n        \n        {\n          bImg_visible && (\n            <ImageGallery\n              id={imgfile.id}\n              cpt={imgfile.cpt}\n              ext={imgfile.ext}\n              closeDialog={this.closeDialog}\n              onPiece={this.onPiece}\n              nextPage={this.nextPage}\n            />\n          )\n        }\n      </div>\n    );\n  }\n}\n\nexport default Feedback;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"feedback_inner\":\"style_feedback_inner__1UQOL\",\"feedback_left\":\"style_feedback_left__VxpUk\",\"feedback_l_head\":\"style_feedback_l_head__3kd8W\",\"feedback_l_body\":\"style_feedback_l_body__R709n\",\"l_listcell\":\"style_l_listcell__1nDTe\",\"subject\":\"style_subject__2U1SA\",\"message\":\"style_message__K4SpM\",\"created\":\"style_created__1zg5X\",\"l_active\":\"style_l_active__TfZl9\",\"feedback_right\":\"style_feedback_right__1oNxi\",\"feedback_right_inner\":\"style_feedback_right_inner__zXtUD\",\"feedback_r_head\":\"style_feedback_r_head__QHTow\",\"r_head_title\":\"style_r_head_title__3gEz9\",\"r_head_bottom\":\"style_r_head_bottom__2Yl5J\",\"r_bottom_body\":\"style_r_bottom_body__3DRXN\",\"detailList\":\"style_detailList__mIFRj\",\"list\":\"style_list__1YGlT\",\"attach\":\"style_attach__unvYo\",\"bottom_btn\":\"style_bottom_btn__2tD07\",\"fb_block\":\"style_fb_block__241Jp\",\"fb_lable\":\"style_fb_lable__2SAuD\",\"fb_tips\":\"style_fb_tips__37Ing\",\"fb_title_tips\":\"style_fb_title_tips__3ZDSe\",\"fb_lable1\":\"style_fb_lable1__3IDjB\",\"fb_textarea\":\"style_fb_textarea__2Fdg9\"};"],"sourceRoot":""}