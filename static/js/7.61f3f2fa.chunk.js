(this.webpackJsonplovcube=this.webpackJsonplovcube||[]).push([[7],{1090:function(e,t,a){"use strict";a.r(t);a(147);var n,i,r,s,o,l=a(57),c=(a(897),a(985)),m=(a(171),a(100)),p=(a(837),a(896)),u=(a(291),a(173)),f=(a(75),a(9)),d=(a(297),a(165)),h=(a(292),a(86)),v=(a(80),a(23)),b=a(10),g=a(12),E=a(19),y=a(20),C=a(21),O=(a(838),a(895)),_=(a(904),a(1089)),j=a(0),w=a.n(j),k=a(116),N=a(31),S=a(37),x=(a(907),a(6)),R=a(7),I=a(835),q=(a(211),a(130)),A=Object(N.b)()(n=O.a.create({name:"questions"})(n=function(e){function t(){return Object(b.a)(this,t),Object(E.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.props.form.setFieldsValue({text:this.props.val})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,i=e.form,r=e.t,s=i.getFieldDecorator;return w.a.createElement(q.a,{visible:t,title:r("CustomQuestions"),okText:r("Determine"),onOk:n,onCancel:a,getContainer:!1},w.a.createElement(O.a.Item,{label:r("securityQuestion")},s("text",{rules:[{required:!0,message:r("enterQuestion"),whitespace:!0},{max:100,message:r("Notmorechar")}]})(w.a.createElement(p.a,{autoComplete:"off",placeholder:r("enterQuestion")}))))}}]),t}(j.Component))||n)||n,D=a(299),F=a(149),M=_.a.Option,P=(i=Object(N.b)(),r=O.a.create({name:"perfectinformation"}),s=Object(S.b)("login","playlist","rahmen","photoalbum"),i(o=r(o=Object(k.g)(o=s(o=Object(S.c)(o=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(y.a)(t).call(this,e))).show=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({pro_visible:!0,fiag:!0})},a.setCustom=function(e){a.setState({custom:!0,checkId:0}),setTimeout((function(){a.customRef.current.focus()}),0)},a.input_focus=function(e,t){e.nativeEvent.stopImmediatePropagation(),a.setState({focus:t})},a.input_blur=function(e){e.nativeEvent.stopImmediatePropagation(),a.setState({focus:null})},a.headporId=function(e,t){a.props.login.changeInfo("profile",{id:t}),a.setState({profile_id:t})},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFieldsAndScroll((function(e,t){if(!e){var n={nickname:Object(x.u)(t.nickname),email:t.email,pwd_question:t.question,pwd_answer:t.answer};if(a.state.profile_id&&(n.profile_id=a.state.profile_id),a.state.show)return void v.a.error(a.t("boundmail"));a.props.login.info_login(n,(function(){var e=x.r.get("user"),t={name:e.name,pwd:e.pwd};a.props.login.login_in(t,(function(){a.props.history.push("/")}))}))}}))},a.handleCancel=function(){a.setState({visible:!1})},a.handleCreate=function(){var e=a.formRef.props.form;e.validateFields((function(t,n){t||(a.props.form.setFieldsValue({question:Object(x.u)(n.text)}),e.resetFields(),a.setState({visible:!1}))}))},a.saveFormRef=function(e){a.formRef=e},a.getAvatar=function(){return"".concat(Object(R.b)(),"/uf/s/").concat(a.state.profile_id,"/").concat(a.state.user_id)},a.addItem=function(){var e=a.props.form.getFieldValue("question")||"";a.setState({questionVal:e,visible:!0})},a.AnswerValidity=function(e,t,n){return t.length<2?n(a.props.t("answerValidity")):Object(x.t)(t)?n():void n(a.props.t("answerValidity"))},a.check_email=function(e){Object(R.c)("user_check_email",e.target.value).then((function(e){a.setState({show:!0})})).catch((function(e){2===e.state&&a.setState({show:!1})}))},a.nameRef=w.a.createRef(),a.emailRef=w.a.createRef(),a.answerRef=w.a.createRef(),a.customRef=w.a.createRef(),a.t=a.props.t,a.state={head_visible:!1,problemList:[{id:1,text:a.t("birthday")},{id:2,text:a.t("yourmind")},{id:3,text:a.t("favoriteperson")}],focus:null,profile_id:null,fiag:!1,visible:!1,user_id:null,show:!1,questionVal:""},a}return Object(C.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=x.r.get("user"),t=this.props.match.params.id;Number(t)===e.id?this.setState({user_id:t}):(e&&Object(R.c)("user_logout",null),x.r.remove("user"),this.props.history.push("/login"))}},{key:"change",value:function(e,t){e.stopPropagation();var a=this.state.problemList,n=a.findIndex((function(e){return e.id===t}));this.setState({custom:!1,checkId:t,problem:a[n].text,pro_visible:!1})}},{key:"render",value:function(){var e=this,t=this.props.t,a=this.props.form.getFieldDecorator,n=this.state,i=n.problemList,r=n.show,s=n.head_visible,o=n.profile_id,v=n.questionVal,b=r?{hasFeedback:!0,validateStatus:"error"}:{};return w.a.createElement("div",{className:"perfectinformation-content"},w.a.createElement(D.a,{buyUrl:F.a,title:t("PerfectInfo")}),w.a.createElement("div",{className:"perfectinformation-inner"},w.a.createElement("div",{className:"perfectinformation-head"},w.a.createElement("h2",null,t("PerfectInfo")),w.a.createElement("span",{className:"hint"},"ps:",t("required"))),w.a.createElement(u.a,{className:"info_Avatar"},w.a.createElement(h.a,{xs:{span:6}},w.a.createElement("span",{className:"info_label"},t("HeadPortrait"),":")),w.a.createElement(h.a,{xs:{span:18}},w.a.createElement("div",{className:"profile_picture",onClick:function(){e.setState({head_visible:!0})}},o?w.a.createElement("img",{alt:"profile",src:this.getAvatar()}):w.a.createElement(d.a,{size:56,icon:"user"}),w.a.createElement(f.a,{className:"right-rigth",type:"right"})))),w.a.createElement(O.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{onSubmit:this.handleSubmit}),w.a.createElement(O.a.Item,{label:t("Nickname")},w.a.createElement(m.a,{placement:"topLeft",overlayClassName:"tooltip",trigger:"focus",title:t("regrule4")},a("nickname",{rules:[{required:!0,message:t("NicknameEmpty"),whitespace:!0},{pattern:x.l.nickname,message:t("nicknameValidity")}]})(w.a.createElement(p.a,{autoComplete:"off",size:"large",maxLength:50,placeholder:t("SetNickname")})))),w.a.createElement(O.a.Item,Object.assign({label:t("mailbox")},b),a("email",{rules:[{pattern:x.l.email,message:"The input is not valid E-mail!"},{required:!0,message:t("MailboxEmpty")}]})(w.a.createElement(p.a,{onBlur:this.check_email,autoComplete:"off",size:"large",placeholder:t("SetMailbox")}))),w.a.createElement(O.a.Item,{label:t("securityQuestion")},a("question",{rules:[{required:!0,message:t("selectQuestion")}]})(w.a.createElement(_.a,{size:"large",placeholder:t("selectQuestion"),dropdownRender:function(a){return w.a.createElement("div",null,a,w.a.createElement(c.a,{style:{margin:"4px 0"}}),w.a.createElement("div",{className:"custom-issue",style:{padding:"4px 8px",cursor:"pointer"},onMouseDown:function(e){return e.preventDefault()},onClick:e.addItem},w.a.createElement(f.a,{type:"plus"})," ",t("CustomQuestions")))}},i.map((function(e){return w.a.createElement(M,{key:e.id,value:e.text},e.text)}))))),w.a.createElement(O.a.Item,{label:t("Answer")},w.a.createElement(m.a,{placement:"topLeft",overlayClassName:"tooltip",trigger:"focus",title:t("regrule6")},a("answer",{rules:[{required:!0,message:t("enterAnswer"),whitespace:!0}]})(w.a.createElement(p.a,{size:"large",maxLength:50,placeholder:t("enterAnswer")})))),w.a.createElement(O.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},w.a.createElement(l.a,{className:"confirm-btn",type:"primary",htmlType:"submit"},t("Determine")))),this.state.visible&&w.a.createElement(A,{wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,onCreate:this.handleCreate,val:v})),s&&w.a.createElement(I.a,{callback:this.headporId,handleCancel:function(){e.setState({head_visible:!1})}}),w.a.createElement("div",{className:"l-top"}),w.a.createElement("div",{className:"l-bottom"}))}}]),t}(j.Component))||o)||o)||o)||o)||o);t.default=P},817:function(e,t,a){},835:function(e,t,a){"use strict";a(75);var n,i,r=a(9),s=(a(80),a(23)),o=a(10),l=a(12),c=a(19),m=a(20),p=a(21),u=a(0),f=a.n(u),d=a(115),h=a.n(d),v=a(31),b=a(15),g=a(7),E=a(6),y=(a(817),a(818)),C=a.n(y),O=(a(819),Object(v.b)()(n=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).image=f.a.createRef(),a.state={myCropper:null,afterImg:""},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new C.a(this.image.current,{viewMode:1,dragMode:"none",initialAspectRatio:1,aspectRatio:1,preview:".before",background:!1,autoCropArea:.6,zoomOnWheel:!1});this.setState({myCropper:t},(function(){e.state.myCropper.replace(e.props.img)}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.img;this.props.img!==t&&this.state.myCropper.replace(t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.t,n=t.confirm,i=t.cancel;return f.a.createElement("div",{className:"preview_picture"},f.a.createElement("div",{className:"preview_left"},f.a.createElement("div",{className:"show-img"},f.a.createElement("img",{src:this.props.img,ref:this.image,alt:""})),f.a.createElement("div",{className:"preview_btn"},f.a.createElement("span",{className:"confirm",onClick:function(){n(e.state.myCropper)}},a("Determine")),f.a.createElement("span",{className:"cancel",onClick:i},a("Cancel")))),f.a.createElement("div",{className:"preview_right"},f.a.createElement("p",null,a("imagePreview")),f.a.createElement("div",{className:"before"})))}}]),t}(f.a.Component))||n);var _=Object(v.b)()(i=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){if(e.target.files.length>0){var t=e.target.files[0];if(t.size/1024/1024>3)return void s.a.error(b.a.t("Picsize"));!function(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}(t,(function(e){a.setState({imageUrl:e,file:t})}))}},a.handleCancel=function(){a.props.handleCancel()},a.handleconfirm=function(e){a.props.handleCancel();var t="portrait";s.a.loading({content:"uploading...",key:t,duration:0});var n=a.state.file,i=e.getCroppedCanvas({imageSmoothingQuality:"high"}).toDataURL("image/jpeg"),r=h.a.lib.WordArray.create(i),o=h.a.SHA256(r).toString(),l=Object(E.e)(i);Object(E.b)(l,"".concat(Object(g.b)(),"/up/p/").concat(Object(E.g)("lovtok"),"/").concat(o,"/").concat(n.name)).then((function(e){Object(g.c)("user_profile_id_save",e.id).then((function(n){s.a.success({content:"succeed!",key:t,duration:2}),a.props.callback(null,e.id)})).catch((function(){s.a.error({content:"come to nothing",key:t,duration:3})}))}))},a.imageRef=f.a.createRef(),a.state={imageUrl:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state.imageUrl,a=this.props,n=a.t,i=a.handleCancel;return f.a.createElement("div",{className:"Headportrait-wrap"},f.a.createElement("div",{className:"Modify_the_picture"},f.a.createElement("span",{className:"close-icon",onClick:i},f.a.createElement(r.a,{type:"close"})),f.a.createElement("div",{className:"Modify_head"},n("Headimage")),f.a.createElement("div",{className:"Modify_content"},f.a.createElement("p",null,n("uploadavatar")),f.a.createElement("div",{className:"Modify_openimg"},f.a.createElement("input",{type:"button",className:"pass-portrait-filebtn",name:"openImgBtn",id:"openImgBtn",value:n("Choosepicture")}),f.a.createElement("input",{type:"file",className:"pass-portrait-file",accept:"image/bmp,image/jpeg,image/png",name:"file",id:"fileImg",onChange:function(t){e.handleChange(t)}}),f.a.createElement("span",{className:"pass-portrait-msg"},n("SupportPic"))),t&&f.a.createElement(O,{img:this.state.imageUrl,confirm:this.handleconfirm,cancel:this.handleCancel}))))}}]),t}(f.a.Component))||i;t.a=_},907:function(e,t,a){}}]);
//# sourceMappingURL=7.61f3f2fa.chunk.js.map